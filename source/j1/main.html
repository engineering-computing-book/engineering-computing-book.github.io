<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title> - Engineering Computing Companion Website</title>
    <!-- <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css"/> -->
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
<link rel="stylesheet" href="/assets/css/style.css"/>
<link rel="stylesheet" href="/assets/css/pygments.css"/>
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/font-awesome.min.css"> -->
<!-- <link href="/assets/css/fa/brands.min.css" rel="stylesheet"> -->
<!-- <link href="/assets/css/fa/solid.min.css" rel="stylesheet"> -->
<link href="/assets/css/fa/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
<!-- <script src="/assets/js/pseudocode/build/pseudocode.js">
</script> -->
<!-- <script src="/assets/js/pseudocode/build/pseudocode.css"> -->
  </head>
  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <!-- <div class="mdl-layout--fixed-header mdl-layout__header--scroll"> -->
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout-title">
        <a href="/">Engineering Computing Companion Website</a>
      </span>
      <div class="mdl-layout-spacer mdl-layout--large-screen-only"></div>
      <nav class="mdl-navigation mdl-layout--large-screen-only">
        
      </nav>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title">Engineering Computing</span>
    <nav class="mdl-navigation">
      <div class="nav">
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
            <a class="nav-cha" href="/wb">1 Introduction</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/mk">1.1 Engineering Computing</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/fk">1.2 Computer Architecture {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/gj">1.3 Programming Computers {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/89">1.4 The Development System</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/c0">1.5 Basic Elements of a Program</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/kx">1.6 Lists</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/rq">1.7 Tuples and Ranges</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/ow">1.8 Dictionaries</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/v3">1.9 Functions</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/cl">1.10 Branching</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/ix">1.11 Looping</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/6c">1.12 Summary {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/6e">1.13 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/xq">2 The Structure, Style, and Design of Programs</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/rz">2.1 Python Interpreters and Interactive Sessions</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/v9">2.2 Scripts, Modules, and Imports</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/tq">2.3 The Python Standard Library and Packages</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/yz">2.4 Namespaces, Scopes, and Contexts</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/rf">2.5 Defining Classes</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/l4">2.6 Style Conventions</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/mw">2.7 The Design of Programs</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/vl">2.8 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/r3">3 Numerical Representations, Input and Output, and Graphics</a>
          
          
          
        
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/wa">3.1 Arrays</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/84">3.2 Manipulating, Operating On, and Mapping Over Arrays</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/j4">3.3 Input and Output</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/sy">3.4 Introducing Graphics</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/a5">3.5 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/we">4 Symbolic Analysis and Design</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/ya">4.1 Symbolic Expressions, Variables, and Functions</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/nc">4.2 Manipulating Symbolic Expressions</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/4u">4.3 Solving Equations Algebraically</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/ur">4.4 From Symbolics to Numerics</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/rd">4.5 Vectors and Matrices</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/iu">4.6 Calculus</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/j1">4.7 Solving Ordinary Differential Equations</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/kb">4.8 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/dx">5 Numerical Analysis and Design Techniques [Outlined]</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/1y">5.1 Sets of Linear Algebraic Equations</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/h6">5.2 Nonlinear Sets of Algebraic Equations via Newton-Raphson</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/9k">5.3 Nonlinear Sets of Algebraic Equations via Packages</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/y3">5.4 Integration</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/nj">5.5 Sets of Differential Equations</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/g8">5.6 Optimization via Gradient Descent</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/cq">5.7 Summary {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/mz">5.8 Problems</a>
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/ht">6 Engineering Computing for Design [Incomplete]</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/qu">6.1 Design as Optimization</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/n8">6.2 Representing Design Constraints</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/uf">6.3 Representing Design Problems</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/rt">6.4 Solving Design Problems</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/1d">6.5 Problems</a>
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/ck">A Notebooks [Outlined]</a>
          
          
          
        
          
            
            <a class="nav-cha" href="/av">B Documenting and Presenting Programs [Outlined]</a>
          
          
          
        
          
            
            <a class="nav-cha" href="/vc">C Version Control [Outlined]</a>
          
          
          
        
          
            
            <a class="nav-cha" href="/ry">D Lists of Figures and Tables</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/qj">D.1 List of figures</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/9l">D.2 List of tables</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
        
          </div>
        
      </div>
    </nav>
  </div>
<!-- </div> -->

      <div class="dropdown-container">
        
        <div class="dropdown">
          <button id="menu" class="dropbtn">Links▾</button>
          <div class="dropdown-content">
  <a href="/index.html">Home</a>
</div>
        </div>
      </div>
      <main class="mdl-layout__content">
        <div class="mdl-grid page-container">
  <div class="mdl-card mdl-cell--12-col mdl-shadow--4dp">
    <div class="mdl-card__supporting-text">
      <!-- <div class="section-titles"> -->
        <!-- <div class="section-title"> -->
          <!-- <h1> -->
            <!--  -->
          <!-- </h1> -->
        <!-- </div> -->
      <!-- </div> -->
      <p>Engineering analysis regularly includes the solution of differential equations.
[Differential equations]{.keyword} are those equations that contain derivatives.
An [ordinary differential equation (ODE)]{.keyword} is a differential equation that contains only ordinary, as opposed to partial, derivatives.
A [linear ODE]{.keyword}—one for which constant multiples and sums of solutions are also solutions—is an important type that represent [linear, time-varying (LTV) systems]{.keyword}.
For this class of ODEs, it has been proven that for a set of initial conditions, a unique solution exists [@Kreyszig2010,p. 108].</p>

<p>A [constant-coefficient, linear ODE]{.keyword} can represent [linear, time-invariant (LTI) systems]{.keyword}.
An LTV or LTI system model can be represented as a scalar $n$th-order ODE, or as a system of $n$ 1st-order ODEs.
As a scalar $n$th-order linear ODE, with independent time variable $t$, output function $y(t)$, forcing function $f(t)$, and constant coefficients $a_i$, has the form
\(y^{(n)}(t) + a_{n-1} y^{(n-1)}(t) + \cdots a_1 y'(t) + a_0 y(t) = f(t).\) {#eq:scalar-linear-ode}
The forcing function $f(t)$ can be written as a linear combination of derivatives of the input function $u(t)$ with $m+1 \le n+1$ constant coefficients $b_j$, as follows:
\(f(t) = b_{m} u^{(m)}(t) + b_{m-1} u^{(m-1)}(t) + \cdots + b_1 u'(t) + b_0 u(t).\)
Alternatively, the same LTI system model can be represented by a system of $n$ 1st-order ODEs, which can be written in vector form as
\begin{subequations}\label{eq:state-space-model}
\begin{align}
\vec{x}’(t) &amp;= \mat{A} \vec{x}(t) + \mat{B} \vec{u}(t)\label{eq:state-space-model-state} <br />
\vec{y}(t) &amp;= \mat{C} \vec{x}(t) + \mat{D} \vec{u}(t), \label{eq:state-space-model-output}
\end{align}
\end{subequations}
where $\vec{x}(t)$ is called the state vector, $\vec{u}(t)$ is called the input vector, and $\vec{y}(t)$ is called the output vector (they are actually vector-valued functions of time), and $\mat{A}$, $\mat{B}$, $\mat{C}$, and $\mat{D}$ are matrices containing constants derived from system parameters (e.g., a mass, a spring constant, a capacitance, etc.).
[@Eq:state-space-model] is called an LTI [state-space model]{.keyword}, and it is used to model a great many engineering systems.</p>

<p>Solving ODEs and systems of ODEs is a major topic of mathematical engineering analysis.
It is typically the primary topic of one required course and a secondary topic of several others.
Understanding when these solutions exist, whether they are unique, and how they can be found adds much to the understanding of engineering systems.
However, it is also true that CASs such as SymPy offer the engineer excellent tools for making quick and adaptable work of this task.</p>

<p>Consider the ODE
\(3 y'(t) + y(t) = f(t),\)
where the forcing function $f(t)$ is defined piecewise as
\(f(t) = \begin{cases} 0 &amp; t &lt; 0 \\ 1 &amp; t \ge 0. \end{cases}\)
The SymPy <code class="language-plaintext highlighter-rouge">dsolve()</code>{.py} function can find the [general solution]{.keyword} (i.e., a family of solutions for any initial conditions) with the following code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">"t"</span><span class="p">,</span> <span class="n">nonnegative</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Function</span><span class="p">(</span><span class="s">"y"</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Or sp.Piecewise(), but $t \ge 0$ already restricts $f(t)$
</span><span class="n">ode</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Eq</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">).</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">f</span><span class="p">)</span>  <span class="c1"># Define the ODE
</span><span class="n">sol</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">));</span> <span class="n">sol</span>  <span class="c1"># Solve
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”2”}</p>
<pre><code class="language-{=latex}">$\displaystyle y{\left(t \right)} = C_{1} e^{- \frac{t}{3}} + 1$
</code></pre>
<p>:::</p>

<p>\noindent
The solution is returned as an <code class="language-plaintext highlighter-rouge">sp.Eq()</code>{.py} equation object.
Note the unknown constant $C_1$ in the solution.
To find the [specific solution]{.keyword} (i.e., the general solution with the initial condition applied to determine $C_1$) for a given initial condition $y(0) = 5$,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sol</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">ics</span><span class="o">=</span><span class="p">{</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="mi">5</span><span class="p">});</span> <span class="n">sol</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”3”}</p>
<pre><code class="language-{=latex}">$\displaystyle y{\left(t \right)} = 1 + 4 e^{- \frac{t}{3}}$
</code></pre>
<p>:::</p>

<p>Now consider the ODE
\(y''(t) + 5 y'(t) + 9 y(t) = 0.\)
The SymPy <code class="language-plaintext highlighter-rouge">dsolve()</code>{.py} function can find the general solution with the following code:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ode</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">).</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">).</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">ode</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">));</span> <span class="n">sol</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”4”}</p>
<pre><code class="language-{=latex}">$\displaystyle y{\left(t \right)} = \left(C_{1} \sin{\left(\frac{\sqrt{11} t}{2} \right)} + C_{2} \cos{\left(\frac{\sqrt{11} t}{2} \right)}\right) e^{- \frac{5 t}{2}}$
</code></pre>
<p>:::</p>

<p>\noindent
This is a decaying sinusoid.
Applying two initial conditions, $y(0) = 4$ and $y’(0) = 0$, we obtain the following:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sol</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">dsolve</span><span class="p">(</span>
    <span class="n">ode</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> 
    <span class="n">ics</span><span class="o">=</span><span class="p">{</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="mi">4</span><span class="p">,</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">).</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">).</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">}</span>
<span class="p">);</span> <span class="n">sol</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”5”}</p>
<pre><code class="language-{=latex}">$\displaystyle y{\left(t \right)} = \left(\frac{20 \sqrt{11} \sin{\left(\frac{\sqrt{11} t}{2} \right)}}{11} + 4 \cos{\left(\frac{\sqrt{11} t}{2} \right)}\right) e^{- \frac{5 t}{2}}$
</code></pre>
<p>:::</p>

<p>\noindent
We see here that to apply the initial condition $y’(0) = 0$, the derivative must be applied before substituting $t \rightarrow 0$.</p>

<p>Solving sets (i.e., systems) of first-order differential equations is similar.
Consider the set of differential equations
\(y_1'(t) = y_2(t) - y_1(t) \text{ and } y_2'(t) = y_1(t) - y_2(t).\)
To find the solution for initial conditions $y_1(0) = 1$ and $y_2(0) = -1$, we can use the following technique:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">"t"</span><span class="p">,</span> <span class="n">nonnegative</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">"y1, y2"</span><span class="p">,</span> <span class="n">cls</span><span class="o">=</span><span class="n">sp</span><span class="p">.</span><span class="n">Function</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">odes</span> <span class="o">=</span> <span class="p">[</span><span class="n">y1</span><span class="p">(</span><span class="n">t</span><span class="p">).</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">y1</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">y2</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y2</span><span class="p">(</span><span class="n">t</span><span class="p">).</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">y2</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">y1</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>
<span class="n">ics</span> <span class="o">=</span> <span class="p">{</span><span class="n">y1</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y2</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">odes</span><span class="p">,</span> <span class="p">[</span><span class="n">y1</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">y2</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="n">ics</span><span class="o">=</span><span class="n">ics</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</code></pre></div></div>

<p>::: {.output .stream .stdout}
    [Eq(y1(t), exp(-2<em>t)), Eq(y2(t), -exp(-2</em>t))]
:::</p>

<p>In engineering, it is common to express a set of differential equations as a state-space model, as in [@eq:state-space-model].
The following example demonstrates how to solve these with SymPy.</p>

<p>::: {.example h=”m4”}</p>

<p>Consider the electromechanical schematic of a direct current (DC) motor shown in [@fig:motor-circuit].
A voltage source $V_S(t)$ provides power, the armature winding loses some energy to heat through a resistance $R$ and stores some energy in a magnetic field due to its inductance $L$, which arises from its coiled structure.
An electromechanical interaction through the magnetic field, shown as M, has torque constant $K_M$ and induces a torque on the motor shaft, which is supported by bearings that lose some energy to heat via a damping coefficient $B$.
The rotor’s mass has rotational moment of inertia $J$, which stores kinetic energy.
We denote the voltage across an element with $v$, the current through an element with $i$, the angular velocity across an element with $\Omega$, and the torque through an element with $T$.</p>

<p><img src="figures/motor-circuit/motor-circuit" alt="An electromechanical schematic of a DC motor." />{#fig:motor-circuit .figure .standalone .nofloat color=bw}</p>

<p>A state-space model state equation in the form of [@eq:state-space-model-state] can be derived for this system, with the result as follows:</p>

<p>\(\underbrace{
\frac{d}{d t}
\begin{bmatrix} 
\Omega_J \\ i_L
\end{bmatrix}
}_{\vec{x}'(t)} = 
\underbrace{
\begin{bmatrix}
  -B/J &amp; K_M/J \\
  -K_M/L &amp; -R/L
\end{bmatrix}
}_{\mat{A}}
\underbrace{
\begin{bmatrix} 
\Omega_J \\ i_L
\end{bmatrix}
}_{\vec{x}(t)} + 
\underbrace{
\begin{bmatrix}
0 \\ 1/L
\end{bmatrix}
}_{\mat{B}}
\underbrace{
\begin{bmatrix} 
V_S
\end{bmatrix}
\vphantom{\begin{bmatrix}0\\0\end{bmatrix}}
}_{\vec{u}(t)}.\)
We choose $\vec{y} = \begin{bmatrix} \Omega_J \end{bmatrix}$ as the output vector, which yields output equation (i.e., [@eq:state-space-model-output])
\(\underbrace{
\begin{bmatrix} \Omega_J \end{bmatrix}
\vphantom{\begin{bmatrix}0\\0\end{bmatrix}}
}_{\vec{y}(t)} = 
\underbrace{
\begin{bmatrix} 1 &amp; 0 \end{bmatrix}
\vphantom{\begin{bmatrix}0\\0\end{bmatrix}}
}_{\mat{C}}
\underbrace{
\begin{bmatrix} 
\Omega_J \\ i_L
\end{bmatrix}
}_{\vec{x}(t)} + 
\underbrace{
\begin{bmatrix} 0 \end{bmatrix}
\vphantom{\begin{bmatrix}0\\0\end{bmatrix}}
}_{\mat{D}} 
\underbrace{
\begin{bmatrix} 
V_S
\end{bmatrix}
\vphantom{\begin{bmatrix}0\\0\end{bmatrix}}
}_{\vec{u}(t)}.\)
Together, these equations are a state-space model for the system.</p>

<p>Solve the state equation for $\vec{x}(t)$ and the output equation for $\vec{y}(t)$ for the following case:</p>

<ul>
  <li>The input voltage $V_S(t) = 1$ V for $t \ge 0$</li>
  <li>The initial condition is $\vec{x}(0) = \vec{0}$</li>
</ul>

<p>::: {.example-solution}</p>

<p>We begin by defining the parameters and functions of time as SymPy symbolic variables and unspecified functions as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">R</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">K_M</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">"R, L, K_M, B, J"</span><span class="p">,</span> <span class="n">positive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">W_J</span><span class="p">,</span> <span class="n">i_L</span><span class="p">,</span> <span class="n">V_S</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">symbols</span><span class="p">(</span>
    <span class="s">"W_J, i_L, V_S"</span><span class="p">,</span> <span class="n">cls</span><span class="o">=</span><span class="n">sp</span><span class="p">.</span><span class="n">Function</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span>
<span class="p">)</span>  <span class="c1"># $\Omega_J, i_L, V_S$
</span><span class="n">t</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">"t"</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>Now we can form the symbolic matrices and vectors:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A_</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="o">-</span><span class="n">B</span><span class="o">/</span><span class="n">J</span><span class="p">,</span> <span class="n">K_M</span><span class="o">/</span><span class="n">J</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">K_M</span><span class="o">/</span><span class="n">L</span><span class="p">,</span> <span class="o">-</span><span class="n">R</span><span class="o">/</span><span class="n">L</span><span class="p">]])</span>  <span class="c1"># $\mat{A}$
</span><span class="n">B_</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="n">L</span><span class="p">]])</span>  <span class="c1"># $\mat{B}$
</span><span class="n">C_</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>  <span class="c1"># $\mat{C}$
</span><span class="n">D_</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">]])</span>  <span class="c1"># $\mat{D}$
</span><span class="n">x</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">W_J</span><span class="p">(</span><span class="n">t</span><span class="p">)],</span> <span class="p">[</span><span class="n">i_L</span><span class="p">(</span><span class="n">t</span><span class="p">)]])</span>  <span class="c1"># $\vec{x}$
</span><span class="n">u</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">V_S</span><span class="p">(</span><span class="n">t</span><span class="p">)]])</span>  <span class="c1"># $\vec{u}$
</span><span class="n">y</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">W_J</span><span class="p">(</span><span class="n">t</span><span class="p">)]])</span>  <span class="c1"># $\vec{y}$
</span></code></pre></div></div>

<p>The input and initial conditions can be encoded as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">u_subs</span> <span class="o">=</span> <span class="p">{</span><span class="n">V_S</span><span class="p">(</span><span class="n">t</span><span class="p">):</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">ics</span> <span class="o">=</span> <span class="p">{</span><span class="n">W_J</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i_L</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="mi">0</span><span class="p">}</span>
</code></pre></div></div>

<p>The set of first-order ODEs comprising the state equation can be defined as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">odes</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">A_</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">B_</span><span class="o">*</span><span class="n">u</span>
<span class="k">print</span><span class="p">(</span><span class="n">odes</span><span class="p">)</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”11”}</p>
<pre><code class="language-{=latex}">$\displaystyle \left[\begin{matrix}\frac{B W_{J}{\left(t \right)}}{J} + \frac{d}{d t} W_{J}{\left(t \right)} - \frac{K_{M} i_{L}{\left(t \right)}}{J}\\\frac{K_{M} W_{J}{\left(t \right)}}{L} + \frac{d}{d t} i_{L}{\left(t \right)} + \frac{R i_{L}{\left(t \right)}}{L} - \frac{V_{S}{\left(t \right)}}{L}\end{matrix}\right]$
</code></pre>
<p>:::</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x_sol</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">dsolve</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">odes</span><span class="p">.</span><span class="n">subs</span><span class="p">(</span><span class="n">u_subs</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">ics</span><span class="o">=</span><span class="n">ics</span><span class="p">)</span>
</code></pre></div></div>

<p>The symbolic solutions for $\bm{x}(t)$ are lengthy expressions.
Instead of printing them, we will graph them for the following set of parameters:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">R</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># (Ohms)
</span>    <span class="n">L</span><span class="p">:</span> <span class="mf">0.1e-6</span><span class="p">,</span>  <span class="c1"># (H)
</span>    <span class="n">K_M</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>  <span class="c1"># (N$\cdot$m/A)
</span>    <span class="n">B</span><span class="p">:</span> <span class="mf">0.1e-6</span><span class="p">,</span>  <span class="c1"># (N$\cdot$m/(rad/s))
</span>    <span class="n">J</span><span class="p">:</span> <span class="mf">2e-6</span><span class="p">,</span>  <span class="c1"># (kg$\cdot$m$^2$)
</span><span class="p">}</span>
</code></pre></div></div>

<p>Create a numerically evaluable version of each function as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">W_J_</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_sol</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">rhs</span><span class="p">.</span><span class="n">subs</span><span class="p">(</span><span class="n">params</span><span class="p">),</span> <span class="n">modules</span><span class="o">=</span><span class="s">"numpy"</span><span class="p">)</span>
<span class="n">i_L_</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">lambdify</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x_sol</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">rhs</span><span class="p">.</span><span class="n">subs</span><span class="p">(</span><span class="n">params</span><span class="p">),</span> <span class="n">modules</span><span class="o">=</span><span class="s">"numpy"</span><span class="p">)</span>
</code></pre></div></div>

<p>Graph each solution as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">t_</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.000002</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span> <span class="n">W_J_</span><span class="p">(</span><span class="n">t_</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">t_</span><span class="p">,</span> <span class="n">i_L_</span><span class="p">(</span><span class="n">t_</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">"Time (s)"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">"$</span><span class="se">\\</span><span class="s">Omega_J(t)$ (rad/s)"</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">"$i_L(t)$ (A)"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”16”}
<img src="source/j1/figure-0.pgf" alt="The state response to a unit step voltage input." />{#fig:j1-figure-0 .figure .pgf}
:::</p>

<p>The output equation is trivial in this case, yielding only the state variable $\Omega_J(t)$, for which we have already solved.
Therefore, we have completed the analysis.</p>

<p>:::
:::</p>

    </div>
  </div>
</div>

        <footer class="mdl-mega-footer">
  <div class="mdl-mega-footer__middle-section">
    
  </div>
  <div class="mdl-mega-footer__bottom-section">
    <ul class="mdl-mega-footer__link-list">
      
    </ul>
  </div>
</footer>

      </main>
    </div>
  </body>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KY4MZ8WFBC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KY4MZ8WFBC');
</script>
  <script src="/assets/js/versioning.js"></script>
<script src="/assets/js/heading-detailer.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"> -->
</script>
<script>
  console.log("running algorithm");
  document.querySelectorAll("pre.algorithm").forEach(function(element) {
    console.log(element);  
    pseudocode.renderElement(element);
  });
</script>
<script src="/assets/js/mathjax_config.js" async></script>
</html>
