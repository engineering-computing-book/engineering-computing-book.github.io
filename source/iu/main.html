<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title> - Engineering Computing Companion Website</title>
    <!-- <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css"/> -->
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
<link rel="stylesheet" href="/assets/css/style.css"/>
<link rel="stylesheet" href="/assets/css/pygments.css"/>
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/font-awesome.min.css"> -->
<!-- <link href="/assets/css/fa/brands.min.css" rel="stylesheet"> -->
<!-- <link href="/assets/css/fa/solid.min.css" rel="stylesheet"> -->
<link href="/assets/css/fa/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
<!-- <script src="/assets/js/pseudocode/build/pseudocode.js">
</script> -->
<!-- <script src="/assets/js/pseudocode/build/pseudocode.css"> -->
  </head>
  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <!-- <div class="mdl-layout--fixed-header mdl-layout__header--scroll"> -->
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout-title">
        <a href="/">Engineering Computing Companion Website</a>
      </span>
      <div class="mdl-layout-spacer mdl-layout--large-screen-only"></div>
      <nav class="mdl-navigation mdl-layout--large-screen-only">
        
      </nav>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title">Engineering Computing</span>
    <nav class="mdl-navigation">
      <div class="nav">
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
            <a class="nav-cha" href="/wb">1 Introduction</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/mk">1.1 Engineering Computing</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/fk">1.2 Computer Architecture {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/gj">1.3 Programming Computers {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/89">1.4 The Development System</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/c0">1.5 Basic Elements of a Program</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/kx">1.6 Lists</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/rq">1.7 Tuples and Ranges</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/ow">1.8 Dictionaries</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/v3">1.9 Functions</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/cl">1.10 Branching</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/ix">1.11 Looping</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/6c">1.12 Summary {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/6e">1.13 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/xq">2 The Structure, Style, and Design of Programs</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/rz">2.1 Python Interpreters and Interactive Sessions</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/v9">2.2 Scripts, Modules, and Imports</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/tq">2.3 The Python Standard Library and Packages</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/yz">2.4 Namespaces, Scopes, and Contexts</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/rf">2.5 Defining Classes</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/l4">2.6 Style Conventions</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/mw">2.7 The Design of Programs</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/vl">2.8 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/r3">3 Numerical Representations, Input and Output, and Graphics</a>
          
          
          
        
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/wa">3.1 Arrays</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/84">3.2 Manipulating, Operating On, and Mapping Over Arrays</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/j4">3.3 Input and Output</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/sy">3.4 Introducing Graphics</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/a5">3.5 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/we">4 Symbolic Analysis and Design</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/ya">4.1 Symbolic Expressions, Variables, and Functions</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/nc">4.2 Manipulating Symbolic Expressions</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/4u">4.3 Solving Equations Algebraically</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/ur">4.4 From Symbolics to Numerics</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/rd">4.5 Vectors and Matrices</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/iu">4.6 Calculus</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/j1">4.7 Solving Ordinary Differential Equations</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/kb">4.8 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/dx">5 Numerical Analysis and Design Techniques [Outlined]</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/1y">5.1 Sets of Linear Algebraic Equations</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/h6">5.2 Nonlinear Sets of Algebraic Equations via Newton-Raphson</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/9k">5.3 Nonlinear Sets of Algebraic Equations via Packages</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/y3">5.4 Integration</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/nj">5.5 Sets of Differential Equations</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/g8">5.6 Optimization via Gradient Descent</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/cq">5.7 Summary {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/mz">5.8 Problems</a>
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/ht">6 Engineering Computing for Design [Incomplete]</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/qu">6.1 Design as Optimization</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/n8">6.2 Representing Design Constraints</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/uf">6.3 Representing Design Problems</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/rt">6.4 Solving Design Problems</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/1d">6.5 Problems</a>
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/ck">A Notebooks [Outlined]</a>
          
          
          
        
          
            
            <a class="nav-cha" href="/av">B Documenting and Presenting Programs [Outlined]</a>
          
          
          
        
          
            
            <a class="nav-cha" href="/vc">C Version Control [Outlined]</a>
          
          
          
        
          
            
            <a class="nav-cha" href="/ry">D Lists of Figures and Tables</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/qj">D.1 List of figures</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/9l">D.2 List of tables</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
        
          </div>
        
      </div>
    </nav>
  </div>
<!-- </div> -->

      <div class="dropdown-container">
        <div class="dropdown v">
          <button id="vmenu" class="dropbtn vd">v ▾</button>
          <div class="dropdown-content vd">
            <!-- <a id="v1" data-title="Spyder" onclick="set_v('v1')" href=#>v1 <span>Spyder</span></a> -->
<!-- <a id="v2" data-title="VS Code" onclick="set_v('v2')" href=#>v2 <span>VS Code</span></a> -->
<a id="v1" data-title="VS Code" onclick="set_v('v1')" href=#>v1 <span>VS Code</span></a>
          </div>
        </div>
        <!-- <div class="dropdown dsd">
          <button id="dsmenu" class="dropbtn dsd">DX▾</button>
          <div class="dropdown-content dsd">
            <a id="miD1" data-title="Spyder Python development system" onclick="set_v_ds('D1')" href=#>D1 <span>Spyder Python development system</span></a>

          </div>
        </div> -->
        <div class="dropdown">
          <button id="menu" class="dropbtn">Links▾</button>
          <div class="dropdown-content">
  <a href="/index.html">Home</a>
</div>
        </div>
      </div>
      <main class="mdl-layout__content">
        <div class="mdl-grid page-container">
  <div class="mdl-card mdl-cell--12-col mdl-shadow--4dp">
    <div class="mdl-card__supporting-text">
      <!-- <div class="section-titles"> -->
        <!-- <div class="section-title"> -->
          <!-- <h1> -->
            <!--  -->
          <!-- </h1> -->
        <!-- </div> -->
      <!-- </div> -->
      <p>Engineering analysis regularly includes calculus.
Derivatives with respect to time and differential equations (i.e., equations including derivatives) are the key mathematical models of rigid-body mechanics (e.g., statics and dynamics), solid mechanics (e.g., mechanics of materials), fluid mechanics, heat transfer, and electromagnetism.
Integration is necessary for solving differential equations and computing important quantities of interest.
Limits and series expansions are frequently used to in the analytic process to simplify equations and to estimate unkown quantities.
In other words, calculus is central to the enterprise of engineering analysis.</p>

<h2 id="derivatives-derivatives-hzt">Derivatives {#derivatives h=”zt”}</h2>

<p>In SymPy, it is possible to compute the derivative of an expression using the <code class="language-plaintext highlighter-rouge">diff()</code>{.py} function and method, as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">"x, y"</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span>
<span class="n">expr</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Or sp.diff(expr, x)
</span><span class="n">expr</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># Or sp.diff(expr, y)
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”2”}</p>
<pre><code class="language-{=latex}">$\displaystyle 2 x + y$
</code></pre>
<p>:::</p>

<p>::: {.output .execute_result execution_count=”2”}</p>
<pre><code class="language-{=latex}">$\displaystyle x + 2 y$
</code></pre>
<p>:::</p>

<p>Higher-order derivatives can be computed by adding the corresponding integer, as in the following second derivative:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">expr</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Or sp.diff(expr, x, 2)
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”3”}</p>
<pre><code class="language-{=latex}">$\displaystyle 2$
</code></pre>
<p>:::</p>

<p>We can see that the partial derivative is applied to a multivariate expression.
The differentiation can be mixed, as well, as in the following example:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">expr</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">expr</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">simplify</span><span class="p">()</span>  <span class="c1"># $\partial^3/\partial x \partial y^2$
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”4”}</p>
<pre><code class="language-{=latex}">$\displaystyle \frac{2 x^{2} \left(- x^{4} + 14 x^{2} y^{2} - 9 y^{4}\right)}{x^{8} + 4 x^{6} y^{2} + 6 x^{4} y^{4} + 4 x^{2} y^{6} + y^{8}}$
</code></pre>
<p>:::</p>

<p>The option <code class="language-plaintext highlighter-rouge">evaluate=False</code>{.py} will leave the derivative unevaluated until the <code class="language-plaintext highlighter-rouge">doit()</code>{.py} method is called, as in the following example:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">expr</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">expr2</span> <span class="o">=</span> <span class="n">expr</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">evaluate</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span> <span class="n">expr2</span>
<span class="n">expr2</span><span class="p">.</span><span class="n">doit</span><span class="p">()</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”5”}</p>
<pre><code class="language-{=latex}">$\displaystyle \frac{d}{d x} \sin{\left(x \right)}$
</code></pre>
<p>:::</p>

<p>::: {.output .execute_result execution_count=”5”}</p>
<pre><code class="language-{=latex}">$\displaystyle \cos{\left(x \right)}$
</code></pre>
<p>:::</p>

<p>The derivative of an undefined function is left unevaluated, as in the following case:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Function</span><span class="p">(</span><span class="s">"f"</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">expr</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”6”}</p>
<pre><code class="language-{=latex}">$\displaystyle 2 f{\left(x \right)} \frac{d}{d x} f{\left(x \right)} + 3 \frac{d}{d x} f{\left(x \right)}$
</code></pre>
<p>:::</p>

<p>\noindent
As we can see, the chain rule of differentiation was applied automatically.</p>

<p>Differentiation works element-wise on matrices and vectors, just as it works mathematically.
For instance,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">v</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">]])</span>
<span class="n">v</span><span class="p">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”7”}</p>
<pre><code class="language-{=latex}">$\displaystyle \left[\begin{matrix}2 x\\y\end{matrix}\right]$
</code></pre>
<p>:::</p>

<h2 id="integrals-integrals-hnd">Integrals {#integrals h=”nd”}</h2>

<p>To a symbolic integral in SymPy, use the <code class="language-plaintext highlighter-rouge">integrate()</code>{.py} function or method.
For an indefinite integral, pass only the variable over which to integrate, as in</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">symbols</span><span class="p">(</span><span class="s">"x, y"</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">expr</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="n">expr</span><span class="p">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Or sp.integrate(expr, x); $\int x + y\ dx$
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”8”}</p>
<pre><code class="language-{=latex}">$\displaystyle \frac{x^{2}}{2} + x y$
</code></pre>
<p>:::</p>

<p>\noindent
Note that no constant of integration is added, so you may need to add your own.</p>

<p>The definite integral can be computed by providing a triple, as in the following example,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sp</span><span class="p">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># $\int_0^3 x + y\ dx$
</span><span class="n">sp</span><span class="p">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>  <span class="c1"># $\int_1^y x + y\ dx$
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”9”}</p>
<pre><code class="language-{=latex}">$\displaystyle 3 y + \frac{9}{2}$
</code></pre>
<p>:::</p>

<p>::: {.output .execute_result execution_count=”9”}</p>
<pre><code class="language-{=latex}">$\displaystyle \frac{3 y^{2}}{2} - y - \frac{1}{2}$
</code></pre>
<p>:::</p>

<p>Multiple integrals can be computed in a similar fashion, as in the following examples:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sp</span><span class="p">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># $\int_2^3 \int_0^4 x + y\ dx dy$
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”10”}</p>
<pre><code class="language-{=latex}">$\displaystyle 18$
</code></pre>
<p>:::</p>

<p>To create an unevaluated integral object, use the <code class="language-plaintext highlighter-rouge">sp.Integral()</code>{.py} constructor.
To evaluate an unevaluated integral, use the <code class="language-plaintext highlighter-rouge">doit()</code>{.py} method, as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">expr2</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Integral</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span> <span class="n">expr2</span>  <span class="c1"># Unevaluated
</span><span class="n">expr2</span><span class="p">.</span><span class="n">doit</span><span class="p">()</span>  <span class="c1"># Evaluate
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”11”}</p>
<pre><code class="language-{=latex}">$\displaystyle \int \left(x + y\right)\, dx$
</code></pre>
<p>:::</p>

<p>::: {.output .execute_result execution_count=”11”}</p>
<pre><code class="language-{=latex}">$\displaystyle \frac{x^{2}}{2} + x y$
</code></pre>
<p>:::</p>

<p>Integration works over piecewise functions, as in the following example:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Piecewise</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">));</span> <span class="n">f</span>
<span class="n">sp</span><span class="p">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”12”}</p>
<pre><code class="language-{=latex}">$\displaystyle \begin{cases} 0 &amp; \text{for}\: x &lt; 0 \\1 &amp; \text{otherwise} \end{cases}$
</code></pre>
<p>:::</p>

<p>::: {.output .execute_result execution_count=”12”}</p>
<pre><code class="language-{=latex}">$\displaystyle 5$
</code></pre>
<p>:::</p>

<p>The <code class="language-plaintext highlighter-rouge">integrate()</code>{.py} function and method is very powerful, but it may not be able to integrate some functions.
In such cases, it returns an unevaluated integral.</p>

<h2 id="limits-limits-h1a">Limits {#limits h=”1a”}</h2>

<p>In SymPy, a limit can be computed via the <code class="language-plaintext highlighter-rouge">limit()</code>{.py} function and method.
The $\lim_{x\rightarrow 0}$ can be computed as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sp</span><span class="p">.</span><span class="n">limit</span><span class="p">(</span><span class="n">sp</span><span class="p">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># $\lim_{x\rightarrow 0} \tanh(x)/x$
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”13”}</p>
<pre><code class="language-{=latex}">$\displaystyle 1$
</code></pre>
<p>:::</p>

<p>The limit to infinity or negative infinity can be denoted using the <code class="language-plaintext highlighter-rouge">sp.oo</code>{.py} symbol, as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sp</span><span class="p">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">2</span>  <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">sp</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">oo</span><span class="p">)</span>  <span class="c1"># $\lim_{x\rightarrow \infty} (1 - x e^{-x})$
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”14”}</p>
<pre><code class="language-{=latex}">$\displaystyle 2$
</code></pre>
<p>:::</p>

<p>The limit can be left unevaluated using the <code class="language-plaintext highlighter-rouge">sp.Limit()</code>{.py} constructor, as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lim</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Limit</span><span class="p">(</span><span class="mi">2</span>  <span class="o">-</span> <span class="n">x</span> <span class="o">*</span> <span class="n">sp</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">sp</span><span class="p">.</span><span class="n">oo</span><span class="p">);</span> <span class="n">expr</span>  <span class="c1"># Unevaluated
</span><span class="n">lim</span><span class="p">.</span><span class="n">doit</span><span class="p">()</span>  <span class="c1"># Evaluate
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”15”}</p>
<pre><code class="language-{=latex}">$\displaystyle x + y$
</code></pre>
<p>:::</p>

<p>::: {.output .execute_result execution_count=”15”}</p>
<pre><code class="language-{=latex}">$\displaystyle 2$
</code></pre>
<p>:::</p>

<p>The limit can be taken from a direction using the optional fourth argument, as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">expr</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span>
<span class="n">lim_neg</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Limit</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"-"</span><span class="p">);</span> <span class="n">lim_neg</span>
<span class="n">lim_pos</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">Limit</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"+"</span><span class="p">);</span> <span class="n">lim_pos</span>
<span class="n">lim_neg</span><span class="p">.</span><span class="n">doit</span><span class="p">()</span>
<span class="n">lim_pos</span><span class="p">.</span><span class="n">doit</span><span class="p">()</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”16”}</p>
<pre><code class="language-{=latex}">$\displaystyle \lim_{x \to 0^-} \frac{1}{x}$
</code></pre>
<p>:::</p>

<p>::: {.output .execute_result execution_count=”16”}</p>
<pre><code class="language-{=latex}">$\displaystyle \lim_{x \to 0^+} \frac{1}{x}$
</code></pre>
<p>:::</p>

<p>::: {.output .execute_result execution_count=”16”}</p>
<pre><code class="language-{=latex}">$\displaystyle -\infty$
</code></pre>
<p>:::</p>

<p>::: {.output .execute_result execution_count=”16”}</p>
<pre><code class="language-{=latex}">$\displaystyle \infty$
</code></pre>
<p>:::</p>

<h2 id="taylor-series-taylor-series-hwm">Taylor Series {#taylor-series h=”wm”}</h2>

<p>A Taylor series (i.e., Taylor expansion) is an infinite power series approximation of an infinitely differentiable function near some point.
For a function $f(x)$, the Taylor series at point $x_0$ is given by
\(\sum_{n=0}^\infty \frac{f^{(n)}}{n!} (x - x_0)^n = f(x_0) + f'(x_0) (x - x_0) + \frac{f''(x_0)}{2!} (x - x_0)^2 + \cdots.\)
We often represent terms with power order $m$ and greater with the [big-O notation]{.keyword} $O((x-x_0)^m)$.
For instance, for an expansion about $x_0 = 0$,
\(\sum_{n=0}^\infty \frac{f^{(n)}}{n!} (x)^n = f(0) + f'(x_0) (x - x_0) + O(x^2).\)</p>

<p>In SymPy, the Taylor series can be found via the <code class="language-plaintext highlighter-rouge">series()</code>{.py} function or method.
For instance,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span> <span class="o">=</span> <span class="n">sp</span><span class="p">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">series</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># Or sp.series(f, x0=0, n=4)
</span></code></pre></div></div>

<p>::: {.output .execute_result execution_count=”17”}</p>
<pre><code class="language-{=latex}">$\displaystyle x - \frac{x^{3}}{6} + O\left(x^{4}\right)$
</code></pre>
<p>:::</p>

<p>\noindent
The <code class="language-plaintext highlighter-rouge">sp.O()</code>{.py} function, which appears in this result, automatically absorbs higher-order terms.
For instance,</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">x</span><span class="o">**</span> <span class="mi">5</span> <span class="o">+</span> <span class="n">sp</span><span class="p">.</span><span class="n">O</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”18”}</p>
<pre><code class="language-{=latex}">$\displaystyle x^{2} + O\left(x^{4}\right)$
</code></pre>
<p>:::</p>

<p>To remove the <code class="language-plaintext highlighter-rouge">sp.O()</code>{.py} function from an expression, call the <code class="language-plaintext highlighter-rouge">removeO()</code>{.py} method, as follows:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span><span class="p">.</span><span class="n">series</span><span class="p">(</span><span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">).</span><span class="n">removeO</span><span class="p">()</span>
</code></pre></div></div>

<p>::: {.output .execute_result execution_count=”19”}</p>
<pre><code class="language-{=latex}">$\displaystyle - \frac{x^{3}}{6} + x$
</code></pre>
<p>:::</p>

<p>\noindent
Removing the higher-order terms is frequently useful when we would like to use the $n$th-order [Taylor polynomial]{.keyword}, a truncated Taylor series, as an approximation of a function.</p>

    </div>
  </div>
</div>

        <footer class="mdl-mega-footer">
  <div class="mdl-mega-footer__middle-section">
    
  </div>
  <div class="mdl-mega-footer__bottom-section">
    <ul class="mdl-mega-footer__link-list">
      
    </ul>
  </div>
</footer>

      </main>
    </div>
  </body>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KY4MZ8WFBC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KY4MZ8WFBC');
</script>
  <script src="/assets/js/versioning.js"></script>
<script src="/assets/js/heading-detailer.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"> -->
</script>
<script>
  console.log("running algorithm");
  document.querySelectorAll("pre.algorithm").forEach(function(element) {
    console.log(element);  
    pseudocode.renderElement(element);
  });
</script>
<script src="/assets/js/mathjax_config.js" async></script>
</html>
