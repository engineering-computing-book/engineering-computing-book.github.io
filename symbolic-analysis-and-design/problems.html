<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <title> - Engineering Computing Companion Website</title>
    <!-- <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css"/> -->
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"/>
<link rel="stylesheet" href="/assets/css/style.css"/>
<link rel="stylesheet" href="/assets/css/pygments.css"/>
<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/font-awesome.min.css"> -->
<!-- <link href="/assets/css/fa/brands.min.css" rel="stylesheet"> -->
<!-- <link href="/assets/css/fa/solid.min.css" rel="stylesheet"> -->
<link href="/assets/css/fa/all.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.css">
<!-- <script src="/assets/js/pseudocode/build/pseudocode.js">
</script> -->
<!-- <script src="/assets/js/pseudocode/build/pseudocode.css"> -->
  </head>
  <body>
    <div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
      <!-- <div class="mdl-layout--fixed-header mdl-layout__header--scroll"> -->
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <span class="mdl-layout-title">
        <a href="/">Engineering Computing Companion Website</a>
      </span>
      <div class="mdl-layout-spacer mdl-layout--large-screen-only"></div>
      <nav class="mdl-navigation mdl-layout--large-screen-only">
        
      </nav>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title">Engineering Computing</span>
    <nav class="mdl-navigation">
      <div class="nav">
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
            <a class="nav-cha" href="/wb">1 Introduction</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/mk">1.1 Engineering Computing</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/fk">1.2 Computer Architecture {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/gj">1.3 Programming Computers {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/89">1.4 The Development System</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/c0">1.5 Basic Elements of a Program</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/kx">1.6 Lists</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/rq">1.7 Tuples and Ranges</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/ow">1.8 Dictionaries</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/v3">1.9 Functions</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/cl">1.10 Branching</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/ix">1.11 Looping</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/6c">1.12 Summary {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/6e">1.13 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/xq">2 The Structure, Style, and Design of Programs</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/rz">2.1 Python Interpreters and Interactive Sessions</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/v9">2.2 Scripts, Modules, and Imports</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/tq">2.3 The Python Standard Library and Packages</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/yz">2.4 Namespaces, Scopes, and Contexts</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/rf">2.5 Defining Classes</a>
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/l4">2.6 Style Conventions</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/mw">2.7 The Design of Programs</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/vl">2.8 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/r3">3 Numerical Representations, Input and Output, and Graphics</a>
          
          
          
        
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/wa">3.1 Arrays</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/84">3.2 Manipulating, Operating On, and Mapping Over Arrays</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/j4">3.3 Input and Output</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/sy">3.4 Introducing Graphics</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/a5">3.5 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/we">4 Symbolic Analysis and Design</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/ya">4.1 Symbolic Expressions, Variables, and Functions</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/nc">4.2 Manipulating Symbolic Expressions</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/4u">4.3 Solving Equations Algebraically</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/ur">4.4 From Symbolics to Numerics</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/rd">4.5 Vectors and Matrices</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/iu">4.6 Calculus</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/j1">4.7 Solving Ordinary Differential Equations</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/kb">4.8 Problems</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/dx">5 Numerical Analysis and Design Techniques [Outlined]</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/1y">5.1 Sets of Linear Algebraic Equations</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/h6">5.2 Nonlinear Sets of Algebraic Equations via Newton-Raphson</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/9k">5.3 Nonlinear Sets of Algebraic Equations via Packages</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/y3">5.4 Integration</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/nj">5.5 Sets of Differential Equations</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/g8">5.6 Optimization via Gradient Descent</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/cq">5.7 Summary {[}Outlined{]}</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/mz">5.8 Problems</a>
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/ht">6 Engineering Computing for Design [Incomplete]</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/qu">6.1 Design as Optimization</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
            
            <a class="nav-sec" href="/n8">6.2 Representing Design Constraints</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/uf">6.3 Representing Design Problems</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/rt">6.4 Solving Design Problems</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/1d">6.5 Problems</a>
          
          
        
          
          
          
        
          
            
              </div>
              
            
            <a class="nav-cha" href="/ck">A Notebooks [Outlined]</a>
          
          
          
        
          
            
            <a class="nav-cha" href="/av">B Documenting and Presenting Programs [Outlined]</a>
          
          
          
        
          
            
            <a class="nav-cha" href="/vc">C Version Control [Outlined]</a>
          
          
          
        
          
            
            <a class="nav-cha" href="/ry">D Lists of Figures and Tables</a>
          
          
          
        
          
          
            
              <div class="nav-sec-div">
              
            
            <a class="nav-sec" href="/qj">D.1 List of figures</a>
          
          
        
          
          
            
            <a class="nav-sec" href="/9l">D.2 List of tables</a>
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
          
          
          
        
        
          </div>
        
      </div>
    </nav>
  </div>
<!-- </div> -->

      <div class="dropdown-container">
        
        <div class="dropdown">
          <button id="menu" class="dropbtn">Links▾</button>
          <div class="dropdown-content">
  <a href="/index.html">Home</a>
</div>
        </div>
      </div>
      <main class="mdl-layout__content">
        <div class="mdl-grid page-container section-page">
  <div class="mdl-card mdl-cell--12-col mdl-shadow--4dp">
    <div class="mdl-card__supporting-text">
      <!-- <div class="section-titles"> -->
        <!-- <div class="section-title"> -->
          <!-- <h1> -->
            <!--  -->
          <!-- </h1> -->
        <!-- </div> -->
      <!-- </div> -->
      <div class="exercise" data-h="5Z" data-problem-num="4.1">
<p>Let <span class="math inline">\(s \in \mathbb{C}\)</span>. Use SymPy
to perform a partial fraction expansion on the following expression:
<span class="math display">\[
\frac{(s+2) (s + 10)}{s^4 + 8 s^3 + 117 s^2 + 610 s + 500}.
\]</span></p>
<div class="exercise-solution">
<p>First, load SymPy and define the expression:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> sp.symbols(<span class="st">&quot;s&quot;</span>, <span class="bu">complex</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>expr <span class="op">=</span> (s <span class="op">+</span> <span class="dv">2</span>)<span class="op">*</span>(s <span class="op">+</span> <span class="dv">10</span>)<span class="op">/</span>(s<span class="op">**</span><span class="dv">4</span> <span class="op">+</span> <span class="dv">8</span><span class="op">*</span>s<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">117</span><span class="op">*</span>s<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">610</span><span class="op">*</span>s <span class="op">+</span> <span class="dv">500</span>)</span></code></pre></div>
<p>The SymPy <code class="sourceCode python">apart()</code> method can
be directly applied to find the partial fraction expansion:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>expr.apart()</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">

</div>
</div>
</div>
<div class="exercise" data-h="IE" data-problem-num="4.2">
<p>Let <span class="math inline">\(x, a_1, a_2, a_3, a_4 \in
\mathbb{R}\)</span>. Use SymPy to combine the cosine and sine terms that
share arguments into single sinusoids with phase shifts in the following
expression: <span class="math display">\[
a_1 \sin(x) + a_2 \cos(x) + a_3 \sin(2 x) + a_4 \cos(2 x)
\]</span></p>
<div class="exercise-solution">
<p>First, load SymPy as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span></code></pre></div>
<p>Unfortunately, the SymPy <code class="sourceCode python">trigsimp()</code> method doesn’t combine the
cosine and sine terms that share an argument. However, we can define a
functions <code class="sourceCode python">trig_two_to_one()</code> for
performing the two-to-one conversion. The identities we will use are as
follows: $$\begin{align*}
a \cos u + b \sin u &amp;= \sqrt{a^2 + b^2} \sin(u + \arctan(a/b)) \\
&amp;= \sqrt{a^2 + b^2} \cos(u - \arctan(b/a)).
\end{align*}$$ We begin by defining two functions, each of which returns
a dictionary of replacement rules for sin(u) in the identities
above.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _trig_two_to_one_sin_rule(a, b, u):</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>	<span class="co">&quot;&quot;&quot;Replacement rule for sin(u) in a cos(u) + b sin(u) for </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">	converting to a single sin term with a phase</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">	</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">	The identity applied is:</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">		a cos u + b sin u = sqrt(a^2 + b^2) sin(u + atan(a/b))</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">	Returns: A dictionary for replacing sin(u)</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">	&quot;&quot;&quot;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>	identity <span class="op">=</span> a<span class="op">*</span>sp.cos(u) <span class="op">+</span> b<span class="op">*</span>sp.sin(u) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>		<span class="op">-</span> sp.sqrt(a<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> b<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>sp.sin(u <span class="op">+</span> sp.atan(a<span class="op">/</span>b))</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>	sol <span class="op">=</span> sp.solve(identity, [sp.sin(u)], <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> sol[<span class="dv">0</span>]</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> _trig_two_to_one_cos_rule(a, b, u):</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>	<span class="co">&quot;&quot;&quot;Replacement rule for sin(u) in a cos(u) + b sin(u) for </span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">	converting to a single cos term with a phase</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">	</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">	The identity applied is:</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">		a cos u + b sin u = sqrt(a^2 + b^2) cos(u - atan(b/a))</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">	Returns: A dictionary for replacing sin(u)</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">	&quot;&quot;&quot;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>	identity <span class="op">=</span> a<span class="op">*</span>sp.cos(u) <span class="op">+</span> b<span class="op">*</span>sp.sin(u) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>		<span class="op">-</span> sp.sqrt(a<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> b<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>sp.cos(u <span class="op">-</span> sp.atan(b<span class="op">/</span>a))</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>	sol <span class="op">=</span> sp.solve(identity, [sp.sin(u)], <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> sol[<span class="dv">0</span>]</span></code></pre></div>
<p>Now we can write a function to perform the trigonometric
simplification, as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trig_two_to_one(expr: sp.Expr, to: <span class="bu">str</span> <span class="op">=</span> <span class="st">&quot;sin&quot;</span>):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>	<span class="co">&quot;&quot;&quot;Rewrites sin and cos terms that share arguments to single sin </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">	or cos terms</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">	</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">	Applies the following identity:</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">		a cos u + b sin u = sqrt(a^2 + b^2) sin(u + atan(a/b))</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">	or</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">		a cos u + b sin u = sqrt(a^2 + b^2) cos(u - atan(b/a))</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">	depending on the ``to`` argument.</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">	</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co">	Args:</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">		expr: The symbolic expression containing sin(u) and cos(u)</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">		to: Rewrite with &quot;sin&quot; (default) or &quot;cos&quot;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co">	&quot;&quot;&quot;</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>	expr <span class="op">=</span> expr.simplify()</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>	<span class="co"># Identify sin terms</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>	w1 <span class="op">=</span> sp.Wild(<span class="st">&quot;w1&quot;</span>, exclude<span class="op">=</span>[<span class="dv">1</span>])</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>	w2 <span class="op">=</span> sp.Wild(<span class="st">&quot;w2&quot;</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>	sin_terms <span class="op">=</span> expr.find(w1<span class="op">*</span>sp.sin(w2))</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>	sin_arg_amps <span class="op">=</span> {}  <span class="co"># To be: {sin argument: sine amplitude}</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> term <span class="kw">in</span> sin_terms:</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>		arg_amp_rules <span class="op">=</span> term.match(w1<span class="op">*</span>sp.sin(w2))</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>		sin_arg_amps[arg_amp_rules[w2]] <span class="op">=</span> arg_amp_rules[w1]</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>	<span class="co"># Identify cos terms</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>	cos_terms <span class="op">=</span> expr.find(w1<span class="op">*</span>sp.cos(w2))</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>	cos_arg_amps <span class="op">=</span> {}  <span class="co"># To be: {sin argument: sine amplitude}</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> term <span class="kw">in</span> cos_terms:</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>		arg_amp_rules <span class="op">=</span> term.match(w1<span class="op">*</span>sp.cos(w2))</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>		cos_arg_amps[arg_amp_rules[w2]] <span class="op">=</span> arg_amp_rules[w1]</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>	<span class="co"># Replace with wildcard rule</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> sin_arg, sin_amp <span class="kw">in</span> sin_arg_amps.items():</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> to <span class="op">==</span> <span class="st">&quot;sin&quot;</span>:</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>			<span class="cf">if</span> sin_arg <span class="kw">in</span> cos_arg_amps.keys():</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>				cos_amp <span class="op">=</span> cos_arg_amps[sin_arg]</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>				sin_rule <span class="op">=</span> _trig_two_to_one_sin_rule(</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>					cos_amp, sin_amp, sin_arg</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>				)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>				expr <span class="op">=</span> expr.subs(sin_rule)</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>		<span class="cf">elif</span> to <span class="op">==</span> <span class="st">&quot;cos&quot;</span>:</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>			<span class="cf">if</span> sin_arg <span class="kw">in</span> cos_arg_amps.keys():</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>				cos_amp <span class="op">=</span> cos_arg_amps[sin_arg]</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>				cos_rule <span class="op">=</span> _trig_two_to_one_cos_rule(</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>					cos_amp, sin_amp, sin_arg</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>				)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>				expr <span class="op">=</span> expr.subs(cos_rule)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> expr.simplify()</span></code></pre></div>
<p>The expression of interest in the problem is defined here:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x, a1, a2, a3, a4 <span class="op">=</span> sp.symbols(<span class="st">&quot;x, a1, a2, a3, a4&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>expr <span class="op">=</span> a1<span class="op">*</span>sp.sin(x) <span class="op">+</span> a2<span class="op">*</span>sp.cos(x) <span class="op">+</span> a3<span class="op">*</span>sp.sin(<span class="dv">2</span><span class="op">*</span>x) <span class="op">+</span> a4<span class="op">*</span>sp.cos(<span class="dv">2</span><span class="op">*</span>x)</span></code></pre></div>
<p>Apply the function to the expression, rewriting in terms of sine
(first) and cosine (second):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>trig_two_to_one(expr, to<span class="op">=</span><span class="st">&quot;sin&quot;</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>trig_two_to_one(expr, to<span class="op">=</span><span class="st">&quot;cos&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">

</div>
<div class="output execute_result" data-execution_count="6">

</div>
</div>
</div>
<div class="exercise" data-h="K2" data-problem-num="4.3">
<p>Let <span class="math inline">\(s \in \mathbb{C}\)</span> and <span class="math inline">\(a_i, b_j \in \mathbb{R}\)</span>. Consider the
following expression: <span class="math display">\[
\frac{a_3 s^3 + a_2 s^2}{a_1 s + a_0} \cdot \frac{b_2 s^2}{b_1 s + b_0}.
\]</span> Use SymPy to write the expression as a fraction with the
numerator and denominator as polynomials in <span class="math inline">\(s\)</span> with the terms collected such that each
power of <span class="math inline">\(s\)</span> appears only once in
each polynomial.</p>
<div class="exercise-solution">

</div>
</div>
<div class="exercise" data-h="QR" data-problem-num="4.4">
<p>Let <span class="math inline">\(t \in \mathbb{R}\)</span>. Use SymPy
to simplify the following expression: <span class="math display">\[
\frac{\cos(t) + \sin(t)}{\cos(t) - \sin(t)} + (\cos(t) + \sin(t))^2.
\]</span> First try using the <code class="sourceCode python">simplify()</code> function. Then try using the
<code class="sourceCode python">trigsimp()</code> function.</p>
<div class="exercise-solution">

</div>
</div>
<div class="exercise" data-h="W1" data-problem-num="4.5">
<p>Let <span class="math inline">\(x, y, z \in \mathbb{R}\)</span> be
variables and <span class="math inline">\(a, b, c \in
\mathbb{R}\)</span> be parameters. Suppose we have the following
solutions for <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> in terms of <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span>: $$\begin{align}
x &amp;= a^2 + b^2 \\
y &amp;= a^2 - b^2 \\
z &amp;= a^2 b^2.
\end{align}$$ Furthermore, suppose the numerical values of the
parameters are <span class="math display">\[
a = 1,\quad b = 2,\quad c = 3.
\]</span> Use SymPy to substitute the solutions for <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> into the following expression: <span class="math display">\[
\frac{x + y}{x - y} + (x + y)^2 + (x - y)^2 + z^2.
\]</span> The resulting expression should be in terms of <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span> only. Now substitute the numerical
values of the parameters into the expression and evaluate it. The final
result should be a single number.</p>
<div class="exercise-solution">

</div>
</div>
<div class="exercise" data-h="KR" data-problem-num="4.6">
<p>Consider the following equation, where <span class="math inline">\(x
\in \mathbb{C}\)</span> and <span class="math inline">\(a, b, c \in
\mathbb{R_+}\)</span>, <span class="math display">\[
a x^2 + b x + \frac{c}{x} + b^2 = 0.
\]</span> Use SymPy to solve for <span class="math inline">\(x\)</span>.</p>
<div class="exercise-solution">
<p>First, load SymPy as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span></code></pre></div>
<p>Now define the symbolic variables and the equation:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.symbols(<span class="st">&quot;x&quot;</span>, <span class="bu">complex</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>a, b, c <span class="op">=</span> sp.symbols(<span class="st">&quot;a, b, c&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>eq <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> b<span class="op">*</span>x <span class="op">+</span> c<span class="op">/</span>x <span class="op">+</span> b<span class="op">**</span><span class="dv">2</span>  <span class="co"># == 0</span></span></code></pre></div>
<p>Let’s try <code class="sourceCode python">sp.solve()</code>, as
follows:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> sp.solve(eq, x, <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sol)</span></code></pre></div>
<div class="output stream stdout">
<pre class="sourceCode"><code>[{x: -(-3*b**2/a + b**2/a**2)/(3*(sqrt(-4*(-3*b**2/a + b**2/a**2)**3 + (27*c/a - 9*b**3/a**2 + 2*b**3/a**3)**2)/2 + 27*c/(2*a) - 9*b**3/(2*a**2) + b**3/a**3)**(1/3)) - (sqrt(-4*(-3*b**2/a + b**2/a**2)**3 + (27*c/a - 9*b**3/a**2 + 2*b**3/a**3)**2)/2 + 27*c/(2*a) - 9*b**3/(2*a**2) + b**3/a**3)**(1/3)/3 - b/(3*a)}, {x: -(-3*b**2/a + b**2/a**2)/(3*(-1/2 - sqrt(3)*I/2)*(sqrt(-4*(-3*b**2/a + b**2/a**2)**3 + (27*c/a - 9*b**3/a**2 + 2*b**3/a**3)**2)/2 + 27*c/(2*a) - 9*b**3/(2*a**2) + b**3/a**3)**(1/3)) - (-1/2 - sqrt(3)*I/2)*(sqrt(-4*(-3*b**2/a + b**2/a**2)**3 + (27*c/a - 9*b**3/a**2 + 2*b**3/a**3)**2)/2 + 27*c/(2*a) - 9*b**3/(2*a**2) + b**3/a**3)**(1/3)/3 - b/(3*a)}, {x: -(-3*b**2/a + b**2/a**2)/(3*(-1/2 + sqrt(3)*I/2)*(sqrt(-4*(-3*b**2/a + b**2/a**2)**3 + (27*c/a - 9*b**3/a**2 + 2*b**3/a**3)**2)/2 + 27*c/(2*a) - 9*b**3/(2*a**2) + b**3/a**3)**(1/3)) - (-1/2 + sqrt(3)*I/2)*(sqrt(-4*(-3*b**2/a + b**2/a**2)**3 + (27*c/a - 9*b**3/a**2 + 2*b**3/a**3)**2)/2 + 27*c/(2*a) - 9*b**3/(2*a**2) + b**3/a**3)**(1/3)/3 - b/(3*a)}]</code></pre>
</div>
<p>This is a cubic solution, so it is unwieldy.</p>
</div>
</div>
<div class="exercise" data-h="G9" data-problem-num="4.7">
<p>Let <span class="math inline">\(w, x, y, z \in \mathbb{R}\)</span>.
Consider the following system of equations: $$\begin{alignat*}{3}
8 w &amp;{}-{} 6 x &amp;{}+{} 5 y &amp;{}+{} 4 z &amp;{}={} -20 \\
\phantom{3 w} &amp;{}\mathbin{\phantom{+}}{} \phantom{4 x} &amp;{}\mathbin{\phantom{+}}{} 2 y &amp;{}-{} 2 z &amp;{}={} 10 \\
2 w &amp;{}-{} \phantom{3}x &amp;{}+{} 4 y &amp;{}+{} \phantom{3}z &amp;{}={} 0\\
w &amp;{}+{} 4 x &amp;{}-{} 2 y &amp;{}+{} 8 z &amp;{}={} 4.
\end{alignat*}$$ Use SymPy to solve the system for <span class="math inline">\(w\)</span>, <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span>.</p>
<div class="exercise-solution">
<p>Load SymPy as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span></code></pre></div>
<p>Now define the symbolic variables:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>w, x, y, z <span class="op">=</span> sp.symbols(<span class="st">&quot;w, x, y, z&quot;</span>, <span class="bu">complex</span><span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>Define the set of equations:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> [</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>	<span class="dv">8</span><span class="op">*</span>w <span class="op">-</span> <span class="dv">6</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">5</span><span class="op">*</span>y <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>z <span class="op">+</span> <span class="dv">20</span>,  <span class="co"># == 0</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>	<span class="dv">2</span><span class="op">*</span>y <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>z <span class="op">-</span> <span class="dv">10</span>,  <span class="co"># == 0</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>	<span class="dv">2</span><span class="op">*</span>w <span class="op">-</span> x <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>y <span class="op">+</span> z,  <span class="co"># == 0</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>	w <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>x <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>y <span class="op">+</span> <span class="dv">8</span><span class="op">*</span>z <span class="op">-</span> <span class="dv">4</span>, <span class="co"># == 0</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>]</span></code></pre></div>
<p>Let’s try <code class="sourceCode python">sp.solve()</code>, as
follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sol <span class="op">=</span> sp.solve(S, [w, x, y, z], <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sol)</span></code></pre></div>
<div class="output stream stdout">
<pre class="sourceCode"><code>[{w: 564/85, x: 773/85, y: 14/85, z: -411/85}]</code></pre>
</div>
</div>
</div>
<div class="exercise" data-h="IV" data-problem-num="4.8">
<p>Consider the truss shown in fig. <strong>¿fig:truss-03?</strong>. Use
a static analysis and the method of joints to develop a solution for the
force in each member <span class="math inline">\(F_{AC}\)</span>, <span class="math inline">\(F_{AD}\)</span>, etc., and the reaction forces
using the sign convention that tension is positive and compression is
negative. The forces should be expressed in terms of the applied force
<span class="math inline">\(\vec{f}_D\)</span> and the dimensions <span class="math inline">\(w\)</span> and <span class="math inline">\(h\)</span> only. Write a program that <em>solves
for the forces symbolically</em> and answers the following
questions:</p>
<ol>
<li>Which members are in tension?</li>
<li>Which members are in compression?</li>
<li>Are there any members with <span class="math inline">\(0\)</span>
nominal force? If so, which?</li>
<li>Which member (or members) has (or have) the maximum
compression?</li>
<li>Which member (or members) has (or have) the maximum tension?</li>
</ol>
<figure class="real-figure" id="fig:truss-03">
<img src="/assets/figures/truss-03/main.svg" class="figure standalone nofloat " alt=" Figure 4.8" />
<figcaption>Figure 4.8: A truss with pinned joints, supported by two hinges, with an applied load <span class="math inline"><strong>f</strong><sub><em>D</em></sub></span>.</figcaption>
</figure>
<div class="exercise-solution">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Import Packages {-}</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
<section id="static-analysis" class="unnumbered real-section level3" data-shortid="static-analysis">
<h3 class="unnumbered real-section" data-shortid="static-analysis">Static Analysis</h3>
<p>Using the method of joints, we proceed through the joints, summing
forces in the <span class="math inline">\(x\)</span>- and <span class="math inline">\(y\)</span>-directions. We will assume all members
are in tension, and their sign will be positive if this is the case and
negative, otherwise. Beginning with joint A, which includes two reaction
forces <span class="math inline">\(R_{A_x}\)</span> and <span class="math inline">\(R_{A_y}\)</span> from the support, $$\begin{align}
\Sigma F_x &amp;= 0; &amp; R_{A_x} + F_{AD} + F_{AC} \cos\theta &amp;=0 \\
\Sigma F_y &amp;= 0; &amp; R_{A_y} - F_{AC} \sin\theta &amp;= 0.
\end{align}$$ The angle <span class="math inline">\(\theta\)</span> is
known in terms of the dimensions <span class="math inline">\(w\)</span>
and <span class="math inline">\(h\)</span> as <span class="math display">\[\theta = \arctan\frac{h}{w}.\]</span> These
equations can be encode symbolically as follows:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>RAx, RAy, FAC, FAD, theta <span class="op">=</span> sp.symbols(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>	<span class="st">&quot;RAx, RAy, FAC, FAD, theta&quot;</span>, real<span class="op">=</span><span class="va">True</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>h, w <span class="op">=</span> sp.symbols(<span class="st">&quot;h, w&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>eqAx <span class="op">=</span> RAx <span class="op">+</span> FAD <span class="op">+</span> FAC <span class="op">*</span> sp.cos(theta)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>eqAy <span class="op">=</span> RAy <span class="op">-</span> FAC<span class="op">*</span>sp.sin(theta)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>theta_wh <span class="op">=</span> sp.atan(h<span class="op">/</span>w)</span></code></pre></div>
<p>Proceeding to joint B, which also has two reaction forces <span class="math inline">\(R_{B_x}\)</span> and <span class="math inline">\(R_{B_y}\)</span>, $$\begin{align}
\Sigma F_x &amp;= 0; &amp; R_{B_x} + F_{BC} &amp;= 0 \\
\Sigma F_y &amp;= 0; &amp; R_{B_y} &amp;= 0.
\end{align}$$ Encoding these equations,</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>RBx, RBy, FBC  <span class="op">=</span> sp.symbols(<span class="st">&quot;RBx, RBy, FBC&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>eqBx <span class="op">=</span> RBx <span class="op">+</span> FBC</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>eqBy <span class="op">=</span> RBy</span></code></pre></div>
<p>For joint C, $$\begin{align}
\Sigma F_x &amp;= 0; &amp; -F_{BC} - F_{AC} \cos\theta &amp;= 0 \\
\Sigma F_y &amp;= 0; &amp; F_{CD} + F_{AC} \sin\theta &amp;= 0.
\end{align}$$ Encoding these equations,</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>FCD <span class="op">=</span> sp.symbols(<span class="st">&quot;FCD&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>eqCx <span class="op">=</span> <span class="op">-</span>FBC <span class="op">-</span> FAC <span class="op">*</span> sp.cos(theta)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>eqCy <span class="op">=</span> FCD <span class="op">+</span> FAC <span class="op">*</span> sp.sin(theta)</span></code></pre></div>
<p>For joint D, there is an applied load <span class="math inline">\(\vec{f_D}\)</span>, so the analysis proceeds as
follows: $$\begin{align}
\Sigma F_x &amp;= 0; &amp; -F_{AD} - f_D \cos\frac{\pi}{4} &amp;= 0 \\
\Sigma F_y &amp;= 0; &amp; -F_{CD} - f_D \sin\frac{\pi}{4} &amp;= 0.
\end{align}$$ Encoding these equations,</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fD <span class="op">=</span> sp.symbols(<span class="st">&quot;fD&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>eqDx <span class="op">=</span> <span class="op">-</span>FAD <span class="op">-</span> fD <span class="op">*</span> sp.cos(sp.pi<span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>eqDy <span class="op">=</span> <span class="op">-</span>FCD <span class="op">-</span> fD <span class="op">*</span> sp.sin(sp.pi<span class="op">/</span><span class="dv">4</span>)</span></code></pre></div>
<p>In total, we have 8 force equations and 8 unknown forces (4 member
forces and 4 reaction forces). Let’s construct the system and solve it
for the unkown forces, as follows:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>S_forces <span class="op">=</span> [</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>	eqAx, eqAy, eqBx, eqBy, eqCx, eqCy, eqDx, eqDy</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>]  <span class="co"># 8 force equations</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>member_forces <span class="op">=</span> [FAC, FAD, FBC, FCD]  <span class="co"># 5 member forces</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>reaction_forces <span class="op">=</span> [RAx, RAy, RBx, RBy]  <span class="co"># 3 reaction forces</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>forces_unknown <span class="op">=</span> member_forces <span class="op">+</span> reaction_forces  <span class="co"># 8 unkown forces</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>sol_forces <span class="op">=</span> sp.solve(S_forces, forces_unknown, <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>)<span class="op">;</span> sol_forces</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<pre class="sourceCode"><code>[{FAC: sqrt(2)*fD/(2*sin(theta)),
  FAD: -sqrt(2)*fD/2,
  FBC: -sqrt(2)*fD*cos(theta)/(2*sin(theta)),
  FCD: -sqrt(2)*fD/2,
  RAx: sqrt(2)*fD/2 - sqrt(2)*fD*cos(theta)/(2*sin(theta)),
  RAy: sqrt(2)*fD/2,
  RBx: sqrt(2)*fD*cos(theta)/(2*sin(theta)),
  RBy: 0}]</code></pre>
</div>
<p>This solution is in terms of <span class="math inline">\(f_D\)</span>
and <span class="math inline">\(\theta\)</span>. Because <span class="math inline">\(w\)</span> and <span class="math inline">\(h\)</span> are our design parameters, let’s
substitute <code class="sourceCode python">theta_wh</code> such that our
solution is rewritten in terms of <span class="math inline">\(f_D\)</span>, <span class="math inline">\(w\)</span>, and <span class="math inline">\(h\)</span>. Create a <code class="sourceCode python"><span class="bu">dict</span></code> of
solutions as follows:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>forces_wh <span class="op">=</span> {}  <span class="co"># Initialize</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> force <span class="kw">in</span> forces_unknown:</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>	force_wh <span class="op">=</span> force.subs(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>		sol_forces[<span class="dv">0</span>]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>	).subs(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>		theta, theta_wh</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>	).simplify()</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>	forces_wh[force] <span class="op">=</span> force_wh</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>	<span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>force<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>force_wh<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre class="sourceCode"><code>FAC = fD*sqrt(2*h**2 + 2*w**2)/(2*h)
FAD = -sqrt(2)*fD/2
FBC = -sqrt(2)*fD*w/(2*h)
FCD = -sqrt(2)*fD/2
RAx = sqrt(2)*fD*(h - w)/(2*h)
RAy = sqrt(2)*fD/2
RBx = sqrt(2)*fD*w/(2*h)
RBy = 0</code></pre>
</div>
<p>Identify the member forces in tension and compression as follows:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>tension <span class="op">=</span> []  <span class="co"># Initialize list</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>compression <span class="op">=</span> []  <span class="co"># Initialize list</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> force <span class="kw">in</span> member_forces:</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> forces_wh[force] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        tension.append(force)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>force<span class="sc">}</span><span class="ss"> is in tension&quot;</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> forces_wh[force] <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        compression.append(force)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>force<span class="sc">}</span><span class="ss"> is in compression&quot;</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>force<span class="sc">}</span><span class="ss"> is a zero-force member&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre class="sourceCode"><code>FAC is in tension
FAD is in compression
FBC is in compression
FCD is in compression</code></pre>
</div>
<p>Therefore, there are no zero-force members. The maximum compression
depends on the ratio <span class="math inline">\(w/h\)</span>. If <span class="math inline">\(w/h = 1\)</span>, all three members in compression
have the same compression of magnitude <span class="math display">\[
\frac{\sqrt{2}}{2} f_D.
\]</span> This is also the maximum compression if <span class="math inline">\(w/h &lt; 1\)</span>. If <span class="math inline">\(w/h &gt; 1\)</span>, the maximum compression is of
magnitude <span class="math display">\[
\frac{\sqrt{2} w}{2 h} f_D.
\]</span></p>
</section>
</div>
</div>
<div class="exercise" data-h="49" data-problem-num="4.9">
<p>You are designing the truss structure shown in
fig. <strong>¿fig:truss-02?</strong>, which is to support the hanging of
an external load <span class="math inline">\(\bm{f}_C = -f_C
\bm{\hat{j}}\)</span>, where <span class="math inline">\(f_C &gt;
0\)</span>. Your organization plans to offer customers the following
options:</p>
<ul>
<li>Any width (i.e., <span class="math inline">\(2 w\)</span>)</li>
<li>A selection of maximum load magnitudes <span class="math inline">\(L
= f_C / \alpha \in \Gamma\)</span>, where <span class="math inline">\(\Gamma = \{1, 2, 4, 8, 16\}\)</span> kN, and where
<span class="math inline">\(\alpha\)</span> is the factor of safety</li>
</ul>
<p>As the designer, you are to develop a design curve for the dimension
<span class="math inline">\(h\)</span> versus half-width <span class="math inline">\(w\)</span> for each maximum load <span class="math inline">\(L \in \Gamma\)</span>, under the following design
constraints:</p>
<ul>
<li>Minimize the dimension <span class="math inline">\(h\)</span></li>
<li>The tension in all members is no more than a given <span class="math inline">\(T\)</span></li>
<li>The compression in all members is no more than a given <span class="math inline">\(C\)</span></li>
<li>The magnitude of the support force at pin A is no more than a given
<span class="math inline">\(P_A\)</span></li>
<li>The magnitude of the support force at pin D is no more than a given
<span class="math inline">\(P_D\)</span></li>
</ul>
<p>Use a static analysis and the method of joints to develop a solution
for the force in each member <span class="math inline">\(F_{AB}\)</span>, <span class="math inline">\(F_{AC}\)</span>, etc., and the reaction forces
using the sign convention that tension is positive and compression is
negative. Create a Python function that returns <span class="math inline">\(h\)</span> as a function of <span class="math inline">\(w\)</span> for a given set of design parameters
<span class="math inline">\(\{T, C, P_A, P_D, \alpha, L\}\)</span>. Use
the function to create a design curve <span class="math inline">\(h\)</span> versus <span class="math inline">\(2
w\)</span> for each <span class="math inline">\(L \in \Gamma\)</span>,
maximum tension <span class="math inline">\(T = 81\)</span> kN, maximum
compression <span class="math inline">\(C = 81\)</span> kN, maximum
support A load <span class="math inline">\(P_A = 50\)</span> kN, maximum
support D load <span class="math inline">\(P_D = 50\)</span> kN, and a
factor of safety of <span class="math inline">\(\alpha = 5\)</span>.</p>
<figure class="real-figure" id="fig:truss-02">
<img src="/assets/figures/truss-02/truss-02.svg" class="figure standalone nofloat " alt=" Figure 4.9" />
<figcaption>Figure 4.9: A truss with pinned joints, supported by a hinge and a floating support, with an applied load <span class="math inline"><strong>f</strong><sub><em>C</em></sub></span>.</figcaption>
</figure>
<div class="exercise-solution">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#### Import Packages {-}</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
<section id="static-analysis" class="unnumbered real-section level3" data-shortid="static-analysis">
<h3 class="unnumbered real-section" data-shortid="static-analysis">Static Analysis</h3>
<p>Using the method of joints, we proceed through the joints, summing
forces in the <span class="math inline">\(x\)</span>- and <span class="math inline">\(y\)</span>-directions. We will assume all members
are in tension, and their sign will be positive if this is the case and
negative, otherwise. Beginning with joint A, which includes one reaction
force <span class="math inline">\(R_{A}\)</span> from the support,
$$\begin{align}
\Sigma F_x &amp;= 0; &amp; F_{AC} + F_{AB} \cos\theta &amp;=0 \\
\Sigma F_y &amp;= 0; &amp; R_A + F_{AB} \sin\theta &amp;= 0.
\end{align}$$ The angle <span class="math inline">\(\theta\)</span> is
known in terms of the dimensions <span class="math inline">\(w\)</span>
and <span class="math inline">\(h\)</span> as <span class="math display">\[\theta = \arctan\frac{h}{w}.\]</span> These
equations can be encode symbolically as follows:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>RA, FAB, FAC, theta<span class="op">=</span> sp.symbols(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>	<span class="st">&quot;RA, FAB, FAC, theta&quot;</span>, real<span class="op">=</span><span class="va">True</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>h, w <span class="op">=</span> sp.symbols(<span class="st">&quot;h, w&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>eqAx <span class="op">=</span> FAC <span class="op">+</span> FAB<span class="op">*</span>sp.cos(theta)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>eqAy <span class="op">=</span> RA <span class="op">+</span> FAB<span class="op">*</span>sp.sin(theta)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>theta_wh <span class="op">=</span> sp.atan(h<span class="op">/</span>w)</span></code></pre></div>
<p>Proceeding to joint B, $$\begin{align}
\Sigma F_x &amp;= 0; &amp; -F_{AB} \cos\theta + F_{BD} \cos\theta &amp;= 0 \\
\Sigma F_y &amp;= 0; &amp; -F_{AB} \sin\theta - F_{BD} \sin\theta - F_{BC} &amp;= 0.
\end{align}$$ Encoding these equations,</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>FBD, FBC <span class="op">=</span> sp.symbols(<span class="st">&quot;FBD, FBC&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>eqBx <span class="op">=</span> <span class="op">-</span>FAB<span class="op">*</span>sp.cos(theta) <span class="op">+</span> FBD<span class="op">*</span>sp.cos(theta)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>eqBy <span class="op">=</span> <span class="op">-</span>FAB<span class="op">*</span>sp.sin(theta) <span class="op">-</span> FBD<span class="op">*</span>sp.sin(theta) <span class="op">-</span> FBC</span></code></pre></div>
<p>For joint C, there is an externally applied force <span class="math inline">\(\bm{f}_C\)</span>, so the analysis proceeds as
follows: $$\begin{align}
\Sigma F_x &amp;= 0; &amp; -F_{AC} + F_{CD} &amp;= 0 \\
\Sigma F_y &amp;= 0; &amp; F_{BC} - f_C &amp;= 0.
\end{align}$$ Encoding these equations,</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>FCD <span class="op">=</span> sp.symbols(<span class="st">&quot;FCD&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fC <span class="op">=</span> sp.symbols(<span class="st">&quot;fC&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>eqCx <span class="op">=</span> <span class="op">-</span>FAC <span class="op">+</span> FCD</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>eqCy <span class="op">=</span> FBC <span class="op">-</span> fC</span></code></pre></div>
<p>For joint D, the pinned reaction forces <span class="math inline">\(R_{Dx}\)</span> and <span class="math inline">\(R_{Dy}\)</span> are present, so the analysis
proceeds as follows: $$\begin{align}
\Sigma F_x &amp;= 0; &amp; -F_{CD} - F_{BD} \cos\theta + R_{Dx} &amp;= 0 \\
\Sigma F_y &amp;= 0; &amp; F_{BD} \sin\theta + R_{Dy} &amp;= 0.
\end{align}$$ Encoding these equations,</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>RDx, RDy <span class="op">=</span> sp.symbols(<span class="st">&quot;RDx, RDy&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>eqDx <span class="op">=</span> <span class="op">-</span>FCD <span class="op">-</span> FBD<span class="op">*</span>sp.cos(theta) <span class="op">+</span> RDx</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>eqDy <span class="op">=</span> FBD<span class="op">*</span>sp.sin(theta) <span class="op">+</span> RDy</span></code></pre></div>
<p>In total, we have 8 force equations and 8 unknown forces (5 member
forces and 3 reaction forces). Let’s construct the system and solve it
for the unkown forces, as follows:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>S_forces <span class="op">=</span> [</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>	eqAx, eqAy, eqBx, eqBy, eqCx, eqCy, eqDx, eqDy</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>]  <span class="co"># 8 force equations</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>member_forces <span class="op">=</span> [FAB, FAC, FBC, FBD, FCD]  <span class="co"># 5 member forces</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>reaction_forces <span class="op">=</span> [RA, RDx, RDy]  <span class="co"># 3 reaction forces</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>forces_unknown <span class="op">=</span> member_forces <span class="op">+</span> reaction_forces  <span class="co"># 8 unkown forces</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>sol_forces <span class="op">=</span> sp.solve(S_forces, forces_unknown, <span class="bu">dict</span><span class="op">=</span><span class="va">True</span>)<span class="op">;</span> sol_forces</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">
<pre class="sourceCode"><code>[{FAB: -fC/(2*sin(theta)),
  FAC: fC*cos(theta)/(2*sin(theta)),
  FBC: fC,
  FBD: -fC/(2*sin(theta)),
  FCD: fC*cos(theta)/(2*sin(theta)),
  RA: fC/2,
  RDx: 0,
  RDy: fC/2}]</code></pre>
</div>
<p>This solution is in terms of <span class="math inline">\(f_C\)</span>
and <span class="math inline">\(\theta\)</span>. Because <span class="math inline">\(w\)</span> and <span class="math inline">\(h\)</span> are our design parameters, let’s
substitute <code class="sourceCode python">eqtheta</code> such that our
solution is rewritten in terms of <span class="math inline">\(f_F\)</span>, <span class="math inline">\(w\)</span>, and <span class="math inline">\(h\)</span>. Create a list of solutions as
follows:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>forces_wh <span class="op">=</span> {}  <span class="co"># Initialize</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> force <span class="kw">in</span> forces_unknown:</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>	force_wh <span class="op">=</span> force.subs(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>		sol_forces[<span class="dv">0</span>]</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>	).subs(</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>		theta, theta_wh</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>	).simplify()</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>	forces_wh[force] <span class="op">=</span> force_wh</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>	<span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>force<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>force_wh<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre class="sourceCode"><code>FAB = -fC*sqrt(h**2 + w**2)/(2*h)
FAC = fC*w/(2*h)
FBC = fC
FBD = -fC*sqrt(h**2 + w**2)/(2*h)
FCD = fC*w/(2*h)
RA = fC/2
RDx = 0
RDy = fC/2</code></pre>
</div>
<p>Define the constraints as follows:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>C, T, PA, PD <span class="op">=</span> sp.symbols(<span class="st">&quot;C, T, PA, PD&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>member_constraints <span class="op">=</span> {<span class="st">&quot;Tension&quot;</span>: T, <span class="st">&quot;Compression&quot;</span>: C}</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>reaction_constraints <span class="op">=</span> {</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>	PA: (RA, <span class="dv">0</span>), </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>	PD: (RDx, RDy)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>}  <span class="co"># Max magnitude: (x force, y force)</span></span></code></pre></div>
<p>Define a function that encodes the constraints as a list of
expressions that must be nonnegative.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_force_constraints(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>	forces: <span class="bu">dict</span>, </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>	member_forces: <span class="bu">list</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>	member_constraints: <span class="bu">dict</span>, </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>	reaction_constraints: <span class="bu">dict</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>	<span class="co">&quot;&quot;&quot;Returns a list of expressions that must be nonnegative</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">	</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">	Args:</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">		- forces: Force solutions {force symbol: solution}</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co">		- member_forces: List of member symbols [FAB, FAC ...]</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">		- member_constraints: </span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co">			{&quot;Tension&quot;: max tension, &quot;Compression&quot;: max compression}</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co">		- reaction_constraints: </span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co">			{max force symbol: (max x force, max y force)}</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co">	&quot;&quot;&quot;</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>	force_constraints <span class="op">=</span> []</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>	<span class="co"># Append member constraints</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> f_name, f_value <span class="kw">in</span> forces.items():</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> f_name <span class="kw">in</span> member_forces:</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>			<span class="cf">if</span> f_value <span class="op">&gt;</span> <span class="dv">0</span>:  <span class="co"># Tension</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>				force_constraints.append(</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>					member_constraints[<span class="st">&quot;Tension&quot;</span>] <span class="op">-</span> f_value</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>				)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>			<span class="cf">elif</span> f_value <span class="op">&lt;</span> <span class="dv">0</span>:  <span class="co"># Compression</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>				force_constraints.append(</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>					member_constraints[<span class="st">&quot;Compression&quot;</span>] <span class="op">+</span> f_value</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>				)</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>	<span class="co"># Append reaction constraints</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> constraint, pair <span class="kw">in</span> reaction_constraints.items():</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>		force_constraints.append(</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>			constraint <span class="op">-</span> sp.sqrt(pair[<span class="dv">0</span>]<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> pair[<span class="dv">1</span>]<span class="op">**</span><span class="dv">2</span>).subs(forces_wh)</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>		)</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> force_constraints</span></code></pre></div>
<p>Now apply the function:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>constraints <span class="op">=</span> get_force_constraints(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>	forces_wh, member_forces, member_constraints, reaction_constraints</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(constraints)</span></code></pre></div>
<div class="output stream stdout">
<pre class="sourceCode"><code>[C - fC*sqrt(h**2 + w**2)/(2*h), T - fC*w/(2*h), T - fC, C - fC*sqrt(h**2 + w**2)/(2*h), T - fC*w/(2*h), PA - fC/2, PD - fC/2]</code></pre>
</div>
<p>At this point, we can solve for <span class="math inline">\(h\)</span> in each expression that includes <span class="math inline">\(h\)</span>. Because these constraints are to be
nonnegative, solving with equality gives the minimum <span class="math inline">\(h_\text{min}\)</span>. Expressions that don’t
include <span class="math inline">\(h\)</span> must still be checked. We
can use this opportunity to sort the constraint expressions into those
that involve <span class="math inline">\(h\)</span> and those that do
not.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>h_mins <span class="op">=</span> []</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>constraints_to_check <span class="op">=</span> []</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> constraint <span class="kw">in</span> constraints:</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>	<span class="cf">if</span> h <span class="kw">in</span> constraint.free_symbols:</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>		<span class="co"># Solve for h</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>		h_min_sol <span class="op">=</span> sp.solve(constraint, h)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>		<span class="cf">for</span> h_min <span class="kw">in</span> h_min_sol:</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>			h_mins.append(h_min)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>	<span class="cf">else</span>:</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>		constraints_to_check.append(constraint)</span></code></pre></div>
<p>Inspect the <code class="sourceCode python">h_mins</code> and <code class="sourceCode">constraints_to_check</code>:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Min h solutions: </span><span class="sc">{</span>h_mins<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Constraints to be checked: </span><span class="sc">{</span>constraints_to_check<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre class="sourceCode"><code>Min h solutions: [fC*w*sqrt(1/(2*C - fC))/sqrt(2*C + fC), fC*w/(2*T), fC*w*sqrt(1/(2*C - fC))/sqrt(2*C + fC), fC*w/(2*T)]
Constraints to be checked: [T - fC, PA - fC/2, PD - fC/2]</code></pre>
</div>
<p>Finally, define a function to design the truss:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> truss_designer(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>	h_mins: <span class="bu">list</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>	constraints_to_check: <span class="bu">list</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>	design_params: <span class="bu">dict</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>	<span class="co">&quot;&quot;&quot;Returns an expression for h(w) using the design parameters provided</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">	&quot;&quot;&quot;</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>	L <span class="op">=</span> sp.symbols(<span class="st">&quot;L&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>	alpha <span class="op">=</span> sp.symbols(<span class="st">&quot;alpha&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> constraint <span class="kw">in</span> constraints_to_check:</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>		constraint_ <span class="op">=</span> constraint.subs(fC, L<span class="op">*</span>alpha).subs(design_params)</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>		<span class="cf">if</span> constraint_ <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>			<span class="cf">raise</span> <span class="pp">Exception</span>(</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>				<span class="ss">f&quot;Design failed for constraint: </span><span class="sc">{</span>constraint<span class="sc">}</span><span class="ss"> &lt; 0&quot;</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>			)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>	h_mins_ <span class="op">=</span> []</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>	<span class="cf">for</span> h_min <span class="kw">in</span> h_mins:</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>		h_mins_.append(h_min.subs(fC, L<span class="op">*</span>alpha).subs(design_params))</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> <span class="bu">max</span>(h_mins_)  <span class="co"># Maximum h_min</span></span></code></pre></div>
<p>Define the given design parameters in a dictionary:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> sp.symbols(<span class="st">&quot;alpha&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>design_parameters <span class="op">=</span> { </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>	T: <span class="fl">81e3</span>, C: <span class="fl">81e3</span>, PA: <span class="fl">50e3</span>, PD: <span class="fl">50e3</span>, alpha: <span class="dv">5</span>, </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>}  <span class="co"># Forces in N</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>Gamma <span class="op">=</span> [<span class="fl">1e3</span>, <span class="fl">2e3</span>, <span class="fl">4e3</span>, <span class="fl">8e3</span>, <span class="fl">16e3</span>]</span></code></pre></div>
<p>Loop through the <code class="sourceCode">L</code> loads, running
<code class="sourceCode python">truss_designer()</code>:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>h_mins_w <span class="op">=</span> []</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>L <span class="op">=</span> sp.symbols(<span class="st">&quot;L&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> L_ <span class="kw">in</span> Gamma:</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>	design_parameters[L] <span class="op">=</span> L_</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>	h_min <span class="op">=</span> truss_designer(</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>		h_mins, constraints_to_check, design_parameters</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>	)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>	h_mins_w.append(h_min)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>	<span class="bu">print</span>(h_min)</span></code></pre></div>
<div class="output stream stdout">
<pre class="sourceCode"><code>0.0308789086390917*w
0.0618463369994117*w
0.124408521678431*w
0.254802914503365*w
0.56790458868584*w</code></pre>
</div>
<p>Convert these symbolic expressions into numerically evaluable
function, as follows:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>h_min_funs <span class="op">=</span> []</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> h_min <span class="kw">in</span> h_mins_w:</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>	h_min_funs.append(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>		sp.lambdify([w], h_min, modules<span class="op">=</span>np)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>	)</span></code></pre></div>
<p>Plot the design curves as follows:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>w_ <span class="op">=</span> np.linspace(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">101</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>fig, ax, <span class="op">=</span> plt.subplots()</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ih, h_min_fun <span class="kw">in</span> <span class="bu">enumerate</span>(h_min_funs):</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>	ax.semilogy(<span class="dv">2</span><span class="op">*</span>w_, h_min_fun(w_), label<span class="op">=</span><span class="ss">f&quot;L = </span><span class="sc">{</span>Gamma[ih]<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="ss">f&quot;width $2w$ (m)&quot;</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="ss">f&quot;height $h$ (m)&quot;</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">
<figure class="real-figure" id="fig:49-figure-0">
<img src="/assets/source/49/figure-0.svg" class="figure pgf " alt=" Figure " />
<figcaption>Figure : Truss design curve.</figcaption>
</figure>
</div>
</section>
</div>
</div>
<div class="exercise" data-h="W5" data-problem-num="4.10">
<p>Consider an LTI system modeled by the state equation of the
state-space model, eq. <strong>¿eq:state-space-model-state?</strong>. A
<span class="keyword">steady state</span> of a system is defined as the
state vector <span class="math inline">\(\bm{x}(t)\)</span> after the
effects of initial conditions have become relatively small. For a
constant input <span class="math inline">\(\bm{u}(t) =
\overline{\bm{u}}\)</span>, the constant state <span class="math inline">\(\overline{\bm{x}}\)</span> toward which the
system’s response decays can be found by setting the time derivative
vector <span class="math inline">\(\bm{x}&#39;(t) = \bm{0}\)</span>.</p>
<p>Write a Python function <code class="sourceCode python">steady_state()</code> that accepts the
following arguments:</p>
<ul>
<li><code class="sourceCode python">A</code>: A symbolic matrix
representing <span class="math inline">\(A\)</span></li>
<li><code class="sourceCode python">B</code>: A symbolic matrix
representing <span class="math inline">\(B\)</span></li>
<li><code class="sourceCode python">u_const</code>: A symbolic vector
representing <span class="math inline">\(\overline{\bm{u}}\)</span></li>
</ul>
<p> The function should return <code class="sourceCode python">x_const</code>, a symbolic vector representing
<span class="math inline">\(\overline{\bm{x}}\)</span>.</p>
<p>The steady-state output converges to <span class="math inline">\(\overline{\bm{y}}\)</span> the corresponding
output equation of the state-space model,
eq. <strong>¿eq:state-space-model-output?</strong>. Write a second
Python function <code class="sourceCode python">steady_output()</code>
that accepts the following arguments:</p>
<ul>
<li><code class="sourceCode python">C</code>: A symbolic matrix
representing <span class="math inline">\(C\)</span></li>
<li><code class="sourceCode python">D</code>: A symbolic matrix
representing <span class="math inline">\(D\)</span></li>
<li><code class="sourceCode python">u_const</code>: A symbolic vector
representing <span class="math inline">\(\overline{\bm{u}}\)</span></li>
<li><code class="sourceCode python">x_const</code>: A symbolic vector
representing <span class="math inline">\(\overline{\bm{x}}\)</span></li>
</ul>
<p> This function should return <code class="sourceCode python">y_const</code>, a symbolic vector representing
<span class="math inline">\(\overline{\bm{y}}\)</span>.</p>
<p>Apply <code class="sourceCode python">steady_state()</code> and <code class="sourceCode python">steady_output()</code> to the state-space
model of the circuit shown in fig. <strong>¿fig:w5?</strong>, which
includes a resistor with resistance <span class="math inline">\(R\)</span>, an inductor with inductance <span class="math inline">\(L\)</span>, and capacitor with capacitance <span class="math inline">\(C\)</span>. The LTI system is represented by
eq. <strong>¿eq:state-space-model?</strong> with state, input, and
output vectors<br />
<span class="math display">\[
\bm{x}(t) = \begin{bmatrix} v_C(t) \\ i_L(t) \end{bmatrix},\
\bm{u}(t) = \begin{bmatrix} V_S \end{bmatrix},\
\bm{y}(t) = \begin{bmatrix} v_C(t) \\ v_L(t) \end{bmatrix}
\]</span> and the following matrices: <span class="math display">\[
A = \begin{bmatrix} 0 &amp; 1/C \\ -1/L &amp; -R/L \end{bmatrix},\
B = \begin{bmatrix} 0 \\ 1/L \end{bmatrix},\
C = \begin{bmatrix} 1 &amp; 0 \\ -1 &amp; -R \end{bmatrix},\
D = \begin{bmatrix} 0 \\ 1 \end{bmatrix}.
\]</span> Furthermore, let the constant input vector be <span class="math display">\[
\overline{\bm{u}} = \begin{bmatrix} \overline{V_S} \end{bmatrix},
\]</span> for constant <span class="math inline">\(\overline{V_S}\)</span>.</p>
<figure class="real-figure" id="fig:w5">
<img src="/assets/figures/w5/w5.svg" class="figure standalone nofloat " alt=" Figure 4.10" data-color="bw" />
<figcaption>Figure 4.10: An RLC circuit with a voltage source <span class="math inline"><em>V</em><sub><em>S</em></sub>(<em>t</em>)</span>.</figcaption>
</figure>
<div class="exercise-solution">
<p>A constant steady-state, <span class="math inline">\(\bm{x}&#39; =
\bm{0}\)</span> implies, from the state
eq. <strong>¿eq:state-space-model-state?</strong>, $$\begin{align}
\bm{0} &amp;= A \overline{\bm{x}} + B \overline{\bm{u}} \Rightarrow \\
\overline{\bm{x}} &amp;= -A^{-1} B \overline{\bm{u}}.
\end{align}$$ We are now ready to define <code class="sourceCode python">steady_state()</code> as follows:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> steady_state(A, B, u_const):</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>	<span class="co">&quot;&quot;&quot;Returns the symbolic constant steady state vector&quot;&quot;&quot;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>	A <span class="op">=</span> sp.Matrix(A)  <span class="co"># In case A isn&#39;t symbolic</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>	B <span class="op">=</span> sp.Matrix(B)  <span class="co"># In case B isn&#39;t symbolic</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>	u_const <span class="op">=</span> sp.Matrix(u_const)  <span class="co"># In case u_const isn&#39;t symbolic</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>	x_const <span class="op">=</span> <span class="op">-</span>A<span class="op">**-</span><span class="dv">1</span> <span class="op">*</span> B <span class="op">*</span> u_const</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> x_const</span></code></pre></div>
<p>The state-space output equation
eq. <strong>¿eq:state-space-model-output?</strong> is already solved for
the output, so we are ready to write <code class="sourceCode python">steady_output()</code> as follows:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> steady_output(C, D, u_const, x_const):</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>	<span class="co">&quot;&quot;&quot;Returns the symbolic constant steady-state output vector&quot;&quot;&quot;</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>	C <span class="op">=</span> sp.Matrix(C)  <span class="co"># In case C isn&#39;t symbolic</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>	D <span class="op">=</span> sp.Matrix(D)  <span class="co"># In case D isn&#39;t symbolic</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>	u_const <span class="op">=</span> sp.Matrix(u_const)  <span class="co"># In case u_const isn&#39;t symbolic</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>	x_const <span class="op">=</span> sp.Matrix(x_const)  <span class="co"># In case x_const isn&#39;t symbolic</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>	y_const <span class="op">=</span> C<span class="op">*</span>x_const <span class="op">+</span> D<span class="op">*</span>u_const</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> y_const</span></code></pre></div>
<p>Apply these functions to the given state-space model. First, define
the symbolic variables as follows:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>R, L, C1 <span class="op">=</span> sp.symbols(<span class="st">&quot;R, L, C1&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>VS_ <span class="op">=</span> sp.symbols(<span class="st">&quot;VS_&quot;</span>, real<span class="op">=</span><span class="va">True</span>)  <span class="co"># Constant voltage source input</span></span></code></pre></div>
<p>Now define the system and the constant input as follows:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> sp.Matrix([[<span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span>C1], [<span class="op">-</span><span class="dv">1</span><span class="op">/</span>L, <span class="op">-</span>R<span class="op">/</span>L]])  <span class="co"># $A$</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> sp.Matrix([[<span class="dv">0</span>], [<span class="dv">1</span><span class="op">/</span>L]])  <span class="co"># $B$</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> sp.Matrix([[<span class="dv">1</span>, <span class="dv">0</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span>R]])  <span class="co"># $C$</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> sp.Matrix([[<span class="dv">0</span>], [<span class="dv">1</span>]])  <span class="co"># $D$</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>u_const <span class="op">=</span> sp.Matrix([[VS_]])  <span class="co"># $\overline{\bm{u}}$</span></span></code></pre></div>
<p>Find the constant steady state <span class="math inline">\(\overline{\bm{x}}\)</span> as follows:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>x_const <span class="op">=</span> steady_state(A, B, u_const)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x_const)</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">

</div>
<p>Find the constant steady-state output <span class="math inline">\(\overline{\bm{y}}\)</span> as follows:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>y_const <span class="op">=</span> steady_output(C, D, u_const, x_const)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y_const)</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">

</div>
</div>
</div>
<div class="exercise" data-h="8U" data-problem-num="4.11">
<p>Consider the electromechanical state-space model described in <a href="/m4">example</a>. For a given set of parameters, input voltage,
and initial conditions, the following vector-valued functions have been
derived: <span class="math display">\[
\bm{F} = \begin{bmatrix}
\int_0^t v_R(t)\ dt \\
\int_0^t v_L(t)\ dt \\
\int_0^t \Omega_B(t)\ dt \\
\int_0^t \Omega_J(t)\ dt \\
\end{bmatrix} = \begin{bmatrix}
\exp(-t) \\
\exp(-t) \\
1 - \exp(-t) \\
1 - \exp(-t)
\end{bmatrix},
\quad
\bm{G} = \begin{bmatrix}
\int_0^t i_R(t)\ dt \\
\int_0^t i_L(t)\ dt \\
\int_0^t T_B(t)\ dt \\
\int_0^t T_J(t)\ dt \\
\end{bmatrix} = \begin{bmatrix}
\exp(-t) \\
\exp(-t) \\
1 - \exp(-t) \\
\exp(-t)
\end{bmatrix}
\]</span> The instantaneous power lossed or stored by each element is
given by the following vector of products: <span class="math display">\[
\bm{\mathcal{P}}(t) = \begin{bmatrix}
v_R(t) i_R(t) \\
v_L(t) i_L(t) \\
\Omega_B(t) T_B(t) \\
\Omega_J(t) T_J(t)
\end{bmatrix}.
\]</span> The energy <span class="math inline">\(\mathcal{E}(t)\)</span>
of the elements, then, is <span class="math display">\[
\bm{\mathcal{E}}(t) = \int_0^t \bm{\mathcal{P}}(t) dt.
\]</span></p>
<p>Write a program that satisfies the following requirements:</p>
<ol>
<li>It defines a function <code class="sourceCode python">power(F, G)</code> that returns the symbolic
power vector <span class="math inline">\(\bm{\mathcal{P}}(t)\)</span>
from any inputs <span class="math inline">\(\bm{F}\)</span> and <span class="math inline">\(\bm{G}\)</span></li>
<li>It defines a function <code class="sourceCode python">energy(F, G)</code> that returns the symbolic
energy <span class="math inline">\(\bm{\mathcal{E}}(t)\)</span> from any
inputs <span class="math inline">\(\bm{F}\)</span> and <span class="math inline">\(\bm{G}\)</span> (<code class="sourceCode python">energy()</code> should call <code class="sourceCode python">power()</code>)</li>
<li>It tests the <code class="sourceCode python">energy()</code> on the
specific <span class="math inline">\(\bm{F}\)</span> and <span class="math inline">\(\bm{G}\)</span> given above</li>
</ol>
<div class="exercise-solution">
<p>The formula for the power of each element is given, so we are ready
to define <code class="sourceCode python">power()</code> as follows:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> power(F, G):</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>	<span class="co">&quot;&quot;&quot;Returns the power for vectors F and G&quot;&quot;&quot;</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>	F <span class="op">=</span> sp.Matrix(F)  <span class="co"># In case F isn&#39;t symbolic</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>	G <span class="op">=</span> sp.Matrix(G)  <span class="co"># In case G isn&#39;t symbolic</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>	P <span class="op">=</span> F.multiply_elementwise(G)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>	<span class="co"># Alternative using a for loop:</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>	<span class="co"># P = sp.zeros(*F.shape)  # Initialize</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>	<span class="co"># for i, Fi in enumerate(F):</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>	<span class="co"># 	P[i] = Fi * G[i]</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> P</span></code></pre></div>
<p>The formula for the energy stored or dissipated by each element is
given, so we are ready to write <code class="sourceCode python">energy()</code> as follows:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> energy(F, G):</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>	<span class="co">&quot;&quot;&quot;Returns the energy stored for vectors F and G&quot;&quot;&quot;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>	P <span class="op">=</span> power(F, G)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>	E <span class="op">=</span> sp.integrate(P, (t, <span class="dv">0</span>, t))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>	<span class="cf">return</span> E</span></code></pre></div>
<p>Apply these functions to the given <span class="math inline">\(\bm{F}\)</span> and <span class="math inline">\(\bm{G}\)</span>. First, define <span class="math inline">\(\bm{F}\)</span> and <span class="math inline">\(\bm{G}\)</span> as follows:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> sp.symbols(<span class="st">&quot;t&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>F <span class="op">=</span> sp.Matrix([</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>	[sp.exp(<span class="op">-</span>t)], </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>	[sp.exp(<span class="op">-</span>t)], </span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>	[<span class="dv">1</span> <span class="op">-</span> sp.exp(<span class="op">-</span>t)], </span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>	[<span class="dv">1</span> <span class="op">-</span> sp.exp(<span class="op">-</span>t)]</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>])</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> sp.Matrix([</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>	[sp.exp(<span class="op">-</span>t)], </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>	[sp.exp(<span class="op">-</span>t)], </span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>	[<span class="dv">1</span> <span class="op">-</span> sp.exp(<span class="op">-</span>t)], </span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>	[sp.exp(<span class="op">-</span>t)]</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>])</span></code></pre></div>
<p>Now compute the energy:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>E <span class="op">=</span> energy(F, G).simplify()</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(E)</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">

</div>
</div>
</div>
<div class="exercise" data-h="FJ" data-problem-num="4.12">
<p>For the circuit and state-space model given in <a href="/w5">problem
4.10</a>, use SymPy to solve for <span class="math inline">\(\vec{x}(t)\)</span> and <span class="math inline">\(\vec{y}(t)\)</span> given the following:</p>
<ul>
<li>A constant input voltage <span class="math inline">\(V_S(t) =
\overline{V_S}\)</span></li>
<li>Initial condition <span class="math inline">\(\vec{x}(0) =
\vec{0}\)</span></li>
</ul>
<p>Substitute the following parameters into the solution for <span class="math inline">\(\vec{y}(t)\)</span> and create numerically
evaluable functions of time for each variable in <span class="math inline">\(\vec{y}(t)\)</span>: <span class="math display">\[
R = 50\text{ $\Omega$, } L = 10\cdot 10^{-6}\text{ H, } C = 1\cdot
10^{-9}\text{ F, } \overline{V_S} = 10\text{ V}.
\]</span></p>
<p>Plot the outputs in <span class="math inline">\(\vec{y}(t)\)</span>
as functions of time, making sure to choose a range of time over which
the response is best presented. <em>Hint:</em> An appropriate amount of
time is on the scale of microseconds.</p>
<div class="exercise-solution">
<p>Load packages:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
<section id="define-classes" class="unnumbered real-section level2" data-shortid="define-classes">
<h2 class="unnumbered real-section" data-shortid="define-classes">Define
Classes</h2>
<p>We begin by defining the parameters and functions of time as SymPy
symbolic variables and unspecified functions as follows:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>R, L, C <span class="op">=</span> sp.symbols(<span class="st">&quot;R, L, C&quot;</span>, positive<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>v_C, i_L, v_L, V_S <span class="op">=</span> sp.symbols(</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;v_C, i_L, v_L, V_S&quot;</span>, cls<span class="op">=</span>sp.Function, real<span class="op">=</span><span class="va">True</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># $v_C, i_L, V_S$</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> sp.symbols(<span class="st">&quot;t&quot;</span>, real<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>Now we can form the symbolic matrices and vectors:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>A_ <span class="op">=</span> sp.Matrix([[<span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span>C], [<span class="op">-</span><span class="dv">1</span><span class="op">/</span>L, <span class="op">-</span>R<span class="op">/</span>L]])  <span class="co"># $\mat{A}$</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>B_ <span class="op">=</span> sp.Matrix([[<span class="dv">0</span>], [<span class="dv">1</span><span class="op">/</span>L]])  <span class="co"># $\mat{B}$</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>C_ <span class="op">=</span> sp.Matrix([[<span class="dv">1</span>, <span class="dv">0</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span>R]])  <span class="co"># $\mat{C}$</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>D_ <span class="op">=</span> sp.Matrix([[<span class="dv">0</span>], [<span class="dv">1</span>]])  <span class="co"># $\mat{D}$</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Matrix([[v_C(t)], [i_L(t)]])  <span class="co"># $\vec{x}$</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> sp.Matrix([[V_S(t)]])  <span class="co"># $\vec{u}$</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> sp.Matrix([[v_C(t)], [v_L(t)]])  <span class="co"># $\vec{y}$</span></span></code></pre></div>
<p>The input and initial conditions can be encoded as follows:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>u_subs <span class="op">=</span> {V_S(t): <span class="dv">10</span>}</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>ics <span class="op">=</span> {v_C(<span class="dv">0</span>): <span class="dv">0</span>, i_L(<span class="dv">0</span>): <span class="dv">0</span>}</span></code></pre></div>
<p>The set of first-order ODEs comprising the state equation can be
defined as follows:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>odes <span class="op">=</span> x.diff(t) <span class="op">-</span> A_<span class="op">*</span>x <span class="op">-</span> B_<span class="op">*</span>u</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(odes)</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">

</div>
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>x_sol <span class="op">=</span> sp.dsolve(<span class="bu">list</span>(odes.subs(u_subs)), <span class="bu">list</span>(x), ics<span class="op">=</span>ics)</span></code></pre></div>
<p>The symbolic solutions for <span class="math inline">\(\bm{x}(t)\)</span> are lengthy expressions, so we
don’t print them here. Now we can compute the output <span class="math inline">\(\vec{y}(t)\)</span> from
eq. <strong>¿eq:state-space-model-output?</strong> as follows:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>x_sol_dict <span class="op">=</span> {}  <span class="co"># Initialize</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> eq <span class="kw">in</span> x_sol:</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    x_sol_dict[eq.lhs] <span class="op">=</span> eq.rhs  <span class="co"># Make a dict of solutions for subs</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>y_sol <span class="op">=</span> (C_<span class="op">*</span>x <span class="op">+</span> D_<span class="op">*</span>u).subs(x_sol_dict)  <span class="co"># Subs into output equation</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># We will graph the output for the following set of parameters:</span></span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>    R: <span class="dv">50</span>,  <span class="co"># (Ohms)</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    L: <span class="fl">10e-6</span>,  <span class="co"># (H)</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    C: <span class="fl">1e-9</span>, <span class="co"># (F)</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Create a numerically evaluable version of each function as
follows:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>v_C_ <span class="op">=</span> sp.lambdify(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    t, y_sol[<span class="dv">0</span>].subs(params).subs(u_subs), modules<span class="op">=</span><span class="st">&quot;numpy&quot;</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>v_L_ <span class="op">=</span> sp.lambdify(</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    t, y_sol[<span class="dv">1</span>].subs(params).subs(u_subs), modules<span class="op">=</span><span class="st">&quot;numpy&quot;</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Graph each solution as follows:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>t_ <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="fl">0.000002</span>, <span class="dv">201</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].plot(t_, v_C_(t_))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].plot(t_, v_L_(t_))</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">&quot;Time (s)&quot;</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_ylabel(<span class="st">&quot;$v_C(t)$ (rad/s)&quot;</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_ylabel(<span class="st">&quot;$v_L(t)$ (A)&quot;</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output execute_result" data-execution_count="13">
<figure class="real-figure" id="fig:fj-figure-0">
<img src="/assets/source/fj/figure-0.svg" class="figure pgf " alt=" Figure " />
<figcaption>Figure : The state response to a <span class="math inline">10</span> V step input.</figcaption>
</figure>
</div>
<p>The output equation is trivial in this case, yielding only the state
variable <span class="math inline">\(\Omega_J(t)\)</span>, for which we
have already solved. Therefore, we have completed the analysis.</p>
</section>
</div>
</div>

<h2 id="online-resources-for-section-48">Online Resources for Section 4.8</h2>

<p>No online resources.</p>


    </div>
  </div>
</div>

        <footer class="mdl-mega-footer">
  <div class="mdl-mega-footer__middle-section">
    
  </div>
  <div class="mdl-mega-footer__bottom-section">
    <ul class="mdl-mega-footer__link-list">
      
    </ul>
  </div>
</footer>

      </main>
    </div>
  </body>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KY4MZ8WFBC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KY4MZ8WFBC');
</script>
  <script src="/assets/js/versioning.js"></script>
<script src="/assets/js/heading-detailer.js"></script>
<!-- <script src="https://cdn.jsdelivr.net/npm/pseudocode@latest/build/pseudocode.min.js"> -->
</script>
<script>
  console.log("running algorithm");
  document.querySelectorAll("pre.algorithm").forEach(function(element) {
    console.log(element);  
    pseudocode.renderElement(element);
  });
</script>
<script src="/assets/js/mathjax_config.js" async></script>
</html>
